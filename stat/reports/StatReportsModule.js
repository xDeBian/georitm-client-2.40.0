var PRODUCTION=!0;define("text!_common/reports/tmpl/deviceProps.html",[],function(){return'<fieldset class="obj-props<% if(\'undefined\' != typeof hidden && hidden){ %> hidden<% } %>">\n    <legend><%= i18n.objProps %></legend>\n    <input type="hidden" name="properties" value="fake"><% //else we will have defaults in Report %>\n    <div class="row-fluid">\n        <div class="span6">\n            <label class="checkbox">\n                <input type="checkbox" value="extId" name="properties"<% if(_.indexOf(properties, \'extId\') != -1) { %> checked<% } %>>\n                <%= i18n.objIdNumberShort %>\n            </label>\n            <label class="checkbox">\n                <input type="checkbox" value="name" name="properties"<% if(_.indexOf(properties, \'name\') != -1) { %> checked<% } %>>\n                <%= i18n.objName %>\n            </label>\n            <label class="checkbox">\n                <input type="checkbox" value="groups" name="properties"<% if(_.indexOf(properties, \'groups\') != -1) { %> checked<% } %>>\n                <%= i18n.objGroup %>\n            </label>\n            <label class="checkbox">\n                <input type="checkbox" value="carId" name="properties"<% if(_.indexOf(properties, \'carId\') != -1) { %> checked<% } %>>\n                <%= i18n.licenseNumber %>\n            </label>\n\n            <% if(\'undefined\' != typeof showHardwareType) {%>\n            <label class="checkbox">\n                <input type="checkbox" value="deviceTypeName" name="properties"<% if(_.indexOf(properties, \'deviceTypeName\') != -1) { %> checked<% } %>>\n                <%= i18n.objHardwareType %>\n            </label>\n            <% } %>\n\n        </div><div class="span6">\n            <label class="checkbox">\n                <input type="checkbox" value="model" name="properties"<% if(_.indexOf(properties, \'model\') != -1) { %> checked<% } %>>\n                <%= i18n.objModel %>\n            </label>\n            <label class="checkbox">\n                <input type="checkbox" value="type" name="properties"<% if(_.indexOf(properties, \'type\') != -1) { %> checked<% } %>>\n                <%= i18n.vehicleType %>\n            </label>\n            <label class="checkbox">\n                <input type="checkbox" value="vin" name="properties"<% if(_.indexOf(properties, \'vin\') != -1) { %> checked<% } %>>\n                <%= i18n.objVin %>\n            </label>\n            <label class="checkbox">\n                <input type="checkbox" value="year" name="properties"<% if(_.indexOf(properties, \'year\') != -1) { %> checked<% } %>>\n                <%= i18n.objYear %>\n            </label>\n        </div>\n    </div>\n</fieldset>'}),define("_common/reports/ReportsMixin",["jquery","underscore","text!_common/reports/tmpl/deviceProps.html"],function(e,t,r){function n(e,r,n){return function(i){e.find(".alert-groups-list");var a=e.find('select[name="alertGroupId"]'),o="";t.each(i,function(e){o+='<option value="'+e.id+'"'+(t.isArray(n)&&t.indexOf(n,e.id)>-1?" selected":"")+">"+e.name+"</option>"}),a.html(o),a.chosen({disable_search:!0,no_results_text:r.searchNoResults})}}function i(e,r,n){function i(e,r){if(!r.length)return this._alerts;var n=t.filter(e,function(e){return t.indexOf(r,e.groupId)>-1});return n}function a(e){var t=String(e);return 4===t.length?String(Number(t)/10):t}function o(e,r,n){if("undefined"==typeof n){var o=e.val()||[];n=t.map(o,Number)}var l="",d=r,c=s.filter(":checked");if(c.length>0&&c.length<s.length){var m=c.map(function(){return Number(this.value)});d=i(r,m)}t.each(d,function(e){l+='<option value="'+e.code+'"'+(t.isArray(n)&&t.indexOf(n,e.code)>-1?" selected":"")+">"+a(e.code)+" "+e.message+"</option>"}),e.html(l),e.data("chosen")&&e.trigger("chosen:updated")}var s=e.find('.alert-groups-list input[name="alertGroupId"]');return function(t){var i=e.find(".alerts-list"),a=e.find('select[name="alertMessageCode"]');o(a,t,n),s.on("click",function(){o(a,t)}),a.on("chosen:showing_dropdown",function(e,t){var r=t.chosen.container;r.find(".chosen-results li").each(function(){this.setAttribute("title",this.innerText)})}),a.on("chosen:ready change",function(){i.find(".search-choice > span").each(function(){this.setAttribute("title",this.innerText)})}),a.chosen({disable_search:!1,disable_search_threshold:10,no_results_text:r.searchNoResults})}}function a(e,r,n,i,a){return function(o){var s=e.find(".comments-group-params"),l=s.closest("fieldset"),d=e.find(".comments-list"),c=!!a,m=[];m=m.concat(t.map(o.comments,function(e){return e.msg}));var u=t.map(m,function(e){return n({name:"logComment",value:e,label:e,checked:!i||i.indexOf(e)>-1})}).join("");u+=n({name:"_customLogComment",value:1,label:r.otherComments,checked:c}),d.html(u);var p=s.find(".custom-comment-group"),h=p.find("input");if(c&&(p.removeClass("hidden"),h.prop("disabled",!1).val(a)),s.find('input[name="_customLogComment"]').on("click",function(){p.toggleClass("hidden",!this.checked),h.prop("disabled",!this.checked),this.checked&&h.focus()}),!i||i.length){var f=!i||i.length>=m.length,g=l.find("input.select-all");g.prop("checked",f).prop("indeterminate",!f)}(c||i&&i.length)&&l.addClass("opened"),l.selectAll({indeterminates:!0,selector:'input[name="logComment"]'})}}function o(e,r,n){return function(i){var a=i.channels,o=e.find(".channels-list"),s=o.closest("fieldset"),l=n&&n.length;if(a.length){s.removeClass("hidden"),l&&s.addClass("opened");var d=1===a.length,c=[],m=!d&&t.isArray(n),u=d||!m;n&&(c=n.filter(function(e){return a.indexOf(e)>-1}),u=u||c.length===a.length);var p=t.map(a,function(e){return r({name:"channelName",value:e,label:e,checked:u||n.indexOf(e)>-1,readonly:d})}).join("");if(u||c.length){var h=s.find("input.select-all");h.prop("checked",u).prop("indeterminate",!u)}d&&e.find('input[name="allChannelName"]').prop("disabled",!0),o.html(p),s.selectAll({indeterminates:!0,selector:'input[name="channelName"]'})}else s.remove()}}function s(r){var n=new e.Deferred,i=[e.ajax({url:r+"alert-actions/get/"}),e.ajax({url:r+"alert-comments/get/"})];return e.when.apply(null,i).done(function(e,r){n.resolve({actions:t.sortBy(e[0],"num"),comments:t.sortBy(r[0],"num")})}).fail(n.reject),n}r=t.template(r);var l={_buildParameterReportFields:function(t,n,i){var a=new e.Deferred,o=this,s="number"==typeof i?i:i.length;return requirejs(["text!mobile/reports/"+t+"/tmpl/params.html"],function(e){var i=l._renderParameterReportFields.call(o,t,n,s>1,e,r);a.resolve(i[0],i[1])},function(){a.reject()}),a},_renderParameterReportFields:function(e,r,n,i,a){var o=this,s=this.getStoredParam(e,"properties")||["extId","name"],l=this.getStoredParam(e,"dataSource")||r.dataSource,d=r.thresholds,c=this.getStoredParam(e,l+".thresholds")||d[l],m=this.getStoredParam(e,"mintime"),u=this.getTexts();t.isNull(m)&&(m=r.mintime);var p=Math.floor(m/60);return[t.template(i,{i18n:u,propertiesHtml:a({hidden:!n,properties:s,i18n:u}),dataSource:l,thresholds:c,minutes:p,seconds:m-60*p}),function(t){r.showProperies=n,o._initParameterReportFields(e,t,r)}]},_initParameterReportFields:function(r,n,i){var a=this,o=i.minThresholdsDiff,s=n.find("input[name=thresholds]").numeric({decimal:".",negative:i.allowNegative});s.on("change",function(){var r=e(this),a=r.data("index"),l=parseFloat(r.val()),d=r.data("min"),c=r.data("max"),m=s.filter("[data-index="+(0==a?1:0)+"]");if(t.isNaN(l)){var u=i.dataSource,p=n.find("input[name=dataSource]:checked");p.length&&(u=p.val()),l=i.thresholds[u][a],r.val(l)}else d>l?(l=d,r.val(l)):l>c&&(l=c,r.val(l));if(0==a)m.val()<=l&&m.val(l+o);else if(1==a){var h=Math.max(l-o,m.data("min"));h>=l&&r.val(h+o),m.val()>=l&&m.val(h)}}),n.find("input[name=dataSource]").on("click",function(){if(this.checked){var e=a.getStoredParam(r,this.value+".thresholds")||i.thresholds[this.value];s.first().val(e[0]),s.last().val(e[1])}});var l=n.find("input[name=minutes]")[0],d=n.find("input[name=seconds]")[0];e(l).on("change",function(){var e=parseInt(l.value);0>e&&(l.value="0",e=0),60==e?(d.disabled=!0,d.value="0"):(d.disabled=!1,d.max="59",0==e||(d.min="0"))}),e(d).on("change",function(){var e=parseInt(d.value);e<d.min&&(d.value=d.min,e=parseInt(d.min))})},buildTemperatureExtraFields:function(e){var r=t.find(["OUTTEMP","DEVTEMP","COOLTEMP"],function(e){return App.reportAllowedByType(e)});return this._buildParameterReportFields("temperature",{mintime:300,dataSource:r,thresholds:{DEVTEMP:[-40,85],OUTTEMP:[2,6],COOLTEMP:[70,105]},allowNegative:!0,minThresholdsDiff:1},e)},buildVoltageExtraFields:function(e){var r=t.find(["CARPOWER","ACC"],function(e){return App.reportAllowedByType(e)});return this._buildParameterReportFields("voltage",{mintime:300,dataSource:r,thresholds:{CARPOWER:[11,29],ACC:[3.7,4.2]},allowNegative:!1,minThresholdsDiff:.01},e)},buildEngspeedExtraFields:function(e){return this._buildParameterReportFields("engspeed",{dataSource:"default",mintime:0,thresholds:{"default":[0,600,3e3]},allowNegative:!1,minThresholdsDiff:1},e)},_renderDrivesafetyExtraFields:function(n,i,a){var o,s=this.getStoredParam(n,"properties")||["extId","name"],l=new e.Deferred,d=this.getTexts(),c=App.isMapMatchingAllowed()?"paramsMapMatching":"params";return requirejs(["text!mobile/reports/"+n+"/tmpl/"+c+".html"],function(e){var c={i18n:d,isSummary:a,propertiesHtml:r({properties:s,i18n:d})};t.each(i,function(e,t){o=this.getStoredParam(n,t),c[t]=null===o?e:o}.bind(this)),l.resolve(t.template(e,c))}.bind(this)),l},_toggleDrifesafetyCheckboxes:function(e,t){var r=e.find(".checkbox-single"),n=e.find(".checkbox-summary"),i=t?n:r,a=t?r:n;a.addClass("hidden").find("input").prop("disabled",!0),i.removeClass("hidden").find("input").prop("disabled",!1)},_initDrivesafetyExtraFields:function(r,n,i,a){var o=this,s=arguments,d=o.model&&o.model.get("parameters"),c=d?d.zoneId:this.getStoredParam(r,"zoneId")||[];if(l.buildSelectorZone.call(this,{htmlBlock:a,i18n:o._i18n,selected:c}),a.find(".set-defaults").on("click",function(){return t.each(n,function(e,t){o.clearStoredParam(r,t)}),o._renderDrivesafetyExtraFields(r,n,i).done(function(e){a.html(e),o._initDrivesafetyExtraFields.apply(o,s)}),!1}),a.find(".integer").numeric({decimal:!1,negative:!1}),a.find(".positive").numeric({decimal:".",negative:!1}),a.find(".negative").numeric({decimal:".",negative:!0}),App.isMapMatchingAllowed()){var m=a.find('input[name="speedExcessUnits"]'),u=a.find('input[name="speedExcessLimits"]'),p=a.find(".excess-unit");m.on("click",function(){var e=this.value,t=o.getStoredParam("drivesafety","speedExcessLimits")||n.speedExcessLimits;u.each(function(r){this.value=t[e][r]}),p.html("kmh"===e?o.getTexts().kmh:"%")})}else{var h,f=a.find("[data-limitsgroup]");f.each(function(){var t=e(this);h=t.find("input[data-index]"),function(r){var n=r.length;r.on("change",function(){for(var r,i=e(this),a=i.data("index"),o=a,s=i.val(),l=Number(s);o--;)r=t.find('input[data-index="'+o+'"]'),Number(r.val())>=l&&r.val(Math.max(0,l-(a-o)));for(o=a;++o<n;)r=t.find('input[data-index="'+o+'"]'),Number(r.val())<=l&&r.val(l+(o-a))})}(h)})}},buildDrivesafetyExtraFields:function(t){var r=this,n=t.length>1,i=new e.Deferred,a="drivesafety";return requirejs(["mobile/reports/"+a+"/DrivesafetyReport"],function(e){var t=n,o=e.prototype.defaults,s=App.getReportsAndTracksProcessor(),d=s?s.options.objectsDefined:!1;r._renderDrivesafetyExtraFields(a,o,n).done(function(e){i.resolve(e,function(e){if(r._initDrivesafetyExtraFields(a,o,n,e),l._toggleDrifesafetyCheckboxes(e,n),!d){var i=function(r){return r.length?(t=n,n=r.length>1,n!=t&&l._toggleDrifesafetyCheckboxes(e,n),void 0):(App.off("toggleobjects",i),void 0)};App.on("toggleobjects",i),App.once("processorsubmit",function(){App.off("toggleobjects",i)})}},function(){i.reject()})})}),i},_initObjectsPropertiesToggle:function(e,t){var r=e.find("fieldset.obj-props"),n=App.getReportsAndTracksProcessor(),i=n?n.options.objectsDefined:!1;if(t===!1&&r.addClass("hidden"),!i){var a=function(e){r[e.length>1?"removeClass":"addClass"]("hidden")};App.on("toggleobjects",a),App.once("processorsubmit",function(){App.off("toggleobjects",a)})}},buildGuardscallcountExtraFieldsBak:function(){var r=new e.Deferred,n=this;return r.reject(),requirejs(["text!_common/reports/guardscallcount/tmpl/params.html"],function(e){var i=n.get("parent");r.resolve(t.template(e,{i18n:n._i18n,minNumber:i.getUserData("guardscallcount.minNumber")||1}),function(e){e.find("input[name=minNumber]").numeric({decimal:!1,negative:!1})})},function(){r.reject()}),r},getDrivesafetyDefaultParameters:function(){return{accelerationMintime:3,speedingMintime:20,showStatistics:!1,showCalculation:!1,accelerationLimit:2,accelerationWeight:1,brakingLimit:-2,brakingWeight:1,speedLimits:[60,90,110,130],speedWeights:[0,1,3,5],gradeThresholds:[4,7],showSummary:!0,showTop:!0,showListWithViolations:!0,showListWithSumScore:!0,zoneId:[]}},getDrivesafetyMapMatchingDefaultParameters:function(){return Object.assign(t.omit(this.getDrivesafetyDefaultParameters(),"gradeThresholds","showListWithViolations","showListWithSumScore"),{speedingMintime:3,speedExcessLimits:{kmh:[0,20,40,60],percentage:[0,20,50,100]},speedExcessWeights:[0,10,50,100],speedExcessUnits:"kmh",useMileageOrQuantity:"mileage",showObjectsStatistics:!1})},buildObjserviceExtraFields:function(){var r=new e.Deferred,n=this,i="objservice";return requirejs(["text!_common/reports/"+i+"/tmpl/params.html"],function(e){var a=n.getStoredParam(i,"statuses")||["served","service","notServed"],o=n.getStoredParam(i,"roundToDays")!==!1,s=n.getTexts();r.resolve(t.template(e,{i18n:s,statuses:a,roundToDays:o,propertiesHtml:n._renderPropertiesCheckboxes(i)}))},function(){r.reject("templates require failed")}),r},_getObjectPropertiesForReport:function(e){return this.getStoredParam(e,"properties")||["extId","name"]},_renderPropertiesCheckboxes:function(e){var t=this._getObjectPropertiesForReport(e);return r({properties:t,showHardwareType:!0,i18n:this.getTexts()})},buildAlertjournalExtraFields:function(r){var l=new e.Deferred,d=this,c=Number(r[0].get("objType"))===App.TYPE_STAT;return requirejs(["text!_common/reports/alertjournal/tmpl/params.html","text!_common/reports/alertjournal/tmpl/paramCheckbox.html"],function(r,m){m=t.template(m),d.get("parent");var u="alertjournal",p=d._i18n,h=App.getBaseUrl(),f=d.getStoredParam(u,"alertGroupId"),g=d.getStoredParam(u,"alertMessageCode"),v=d.getStoredParam(u,"channelName"),b=d.getStoredParam(u,"logComment"),y=d.getStoredParam(u,"customLogComment"),S=d.getStoredParam(u,"params"),T=function(e){return!S||S.indexOf(e)>-1},x=[{key:"receivedAt",name:p.timeOfReceive,readonly:!0,checked:T("receivedAt")},{key:"alertTs",name:p.timeOfCreation,checked:T("alertTs")},{key:"code",name:p.alertCode,checked:T("code")},{key:"message",name:p.alertOrCommentMessage,checked:T("message"),readonly:!0},{key:"group",name:p.alertsGroup,checked:T("group")},{key:"extId",name:p.objIdNumber,checked:T("extId")},{key:"address",name:p.address.ucFirst(),checked:T("address"),isStationary:!0},{key:"objectName",name:p.objTitle,checked:T("objectName")},{key:"areaNum",name:p.objArea,checked:T("areaNum"),isStationary:!0},{key:"areaName",name:p.objAreaName,checked:T("areaName"),isStationary:!0},{key:"zoneNum",name:p.objZoneKey,checked:T("zoneNum"),isStationary:!0},{key:"zoneName",name:p.objZoneKeyName,checked:T("zoneName"),isStationary:!0},{key:"channelName",name:p.inputStream,checked:T("channelName")},{key:"userId",name:p.userid,checked:T("userId")},{key:"userName",name:p.username.ucFirst(),checked:T("userName")}];l.resolve(t.template(r,{i18n:p,isStationary:c,params:x}),function(t){var r=n(t,p,f),l=[e.ajax({url:h+"alert-template-group/list/"}).done(function(n){r(n),e.ajax({url:h+"alert-template/list/"}).done(i(t,p,g))}),s(h).done(a(t,p,m,b,y)),e.ajax({url:h+"alerts/channels/",data:{}}).done(o(t,m,v))];e.when(l).always(function(){var r=t.closest(".processor");t.on("click",".group-toggle",function(){var t=e(this).closest("fieldset");t.toggleClass("opened",!t.is(".opened")),r.trigger("contentchange")}),setTimeout(function(){r.trigger("contentchange")},500),setTimeout(function(){t.find(".loading").removeClass("loading"),r.trigger("contentchange")},1800)});var d=t.find("fieldset:last-child"),c=!S||S.length>=x.length;d.selectAll({indeterminates:!0,selector:'input[name="params"]'}),d.find("input.select-all").prop("checked",c).prop("indeterminate",!c)})},l.reject),l},buildSelectorZone:function(e){var r=e.htmlBlock,n=e.selected,i=e.i18n||{},a=t.isArray(n)?n:t.isNumber(n)?[n]:[],o="",s=r.find("select[name=zoneId]"),l=App.get("geozones");t.each(l,function(e){o+='<option value="'+e.id+'"'+(t.indexOf(a,e.id)>-1?" selected":"")+">"+e.name+"</option>"}),s.html(o),s.chosen({disable_search:!0,no_results_text:i.searchNoResults})}};return l}),define("text!stat/reports/tmpl/deviceProps.html",[],function(){return'<input type="hidden" name="properties" value="extId">\n<input type="hidden" name="properties" value="name">'}),define("stat/reports/StatReportsModule",["jquery","underscore","abstracts/Module","_common/reports/ReportsMixin","text!stat/reports/tmpl/deviceProps.html","i18n!stat/nls/stat"],function(e,t,r,n,i,a){i=t.template(i);var o=r.extend({constructor:function(){r.apply(this,arguments)},initialize:function(){this._i18n=e.extend({},this.get("parent").getTexts(),a),this.publish("ready",this)},getTexts:function(){return this._i18n},loadReportClass:function(t){var r=t.ucFirst()+"Report",n=t.toLowerCase(),i=new e.Deferred;return requirejs([this.get("objType")+"/reports/"+n+"/"+r],function(e){i.resolve(e)},function(e){i.reject(e)}),i},buildObjstExtraFields:function(){var r=new e.Deferred,n=this,i=n._i18n,a={extId:i.objIdNumber,name:i.objName,status:i.objStatus,shortDescription:i.description,address:i.address.ucFirst(),groups:i.objGroup},o={gsmTime:i.timeOfLastAlert};(App.allowed("objects.edit")||App.allowed("objects.create"))&&t.extend(a,{sim:i.simCard+" 1",sim1Provider:i.gsmProvider+" 1",sim2:i.simCard+" 2",sim2Provider:i.gsmProvider+" 2",pass:i.objServerPassword}),t.extend(a,{imei:"IMEI",rev:i.rev,comment:i.comments.ucFirst(),extraHardware:i.objExtraHardware,equipmentIds:i.objEquipmentIds});var s=t.keys(a).length,l=t.keys(o).length;return requirejs(["text!stat/reports/objst/tmpl/params.html"],function(i){var d=n.get("parent"),c=d.getUserData("objst.prop")||[],m=d.getUserData("objst.sf")||[];t.each(c,function(e){e in a||(c=t.without(c,e))}),c.length||c.push("extId"),r.resolve(t.template(i,{i18n:n._i18n,checkedProps:c,allProps:a,totalProps:s,allSf:o,checkedSf:m,totalSf:l,noAlertsMinutes:d.getUserData("objst.noAlertsMinutes"),alerts_days:d.getUserData("objst.alerts_days")?d.getUserData("objst.alerts_days"):"1",alerts_hours:d.getUserData("objst.alerts_hours")?d.getUserData("objst.alerts_hours"):"",alerts_minutes:d.getUserData("objst.alerts_minutes")?d.getUserData("objst.alerts_minutes"):""}),function(r){r.on("keypress","input[type=text]",function(r){var n=r.keyCode||r.charCode,i=e(r.target).val()+(32>n?"":String.fromCharCode(n));-1==t.indexOf([8,37,38,39,40,46],n)&&i.match(/\D/)&&r.preventDefault()}),r.find("fieldset").each(function(){e(this).selectAll({selector:"input[name="+e(this).data("key")+"]:not([readonly])"})})})},function(){r.reject()}),r},buildObjtempExtraFields:function(){var t=new e.Deferred,r=this;return requirejs(["text!stat/reports/objtemp/tmpl/params.html"],function(e){var i={mintime:300,dataSource:"OUTTEMP",thresholds:{OUTTEMP:[5,30]},allowNegative:!0,minThresholdsDiff:1};t.resolve.apply(t,n._renderParameterReportFields.call(r,"objtemp",i,!1,e,function(){return""}))},function(){t.reject()}),t},_getObjectPropertiesForReport:function(){return["extId","name"]},_renderPropertiesCheckboxes:function(){return i()},getStoredParam:function(e,r){var n=e+"."+r;/^temperature|objservice$/.test(e)&&(n="stat."+n);var i=this.get("parent").getUserData(n);return t.isUndefined(i)||t.isNull(i)?null:i},clearStoredParam:function(e,t){this.get("parent").setUserData(e+"."+t,null)}});return t.each(["buildObjserviceExtraFields","_buildParameterReportFields","_initParameterReportFields","buildAlertjournalExtraFields"],function(e){!function(e){o.prototype[e]=function(){return n[e].apply(this,arguments)}}(e)}),o}),define("_common/reports/Report",["jquery","underscore","jface","abstracts/Module","fileDownload"],function(e,t,r,n){var i=["xls","pdf"],a=n.extend({constructor:function(e){this._module=e.module,this._jsonData=null,this._tracksModule=null,this._children={};var t=this;this.on("sync",function(e,r,n){n.xhr&&(t._jsonData=n.xhr.responseText)}),n.apply(this,arguments)},initialize:function(e){this._view=new e({id:"report-"+this.id,className:"tab-hor-content report",model:this,container:this.get("module").getReportsContainer(),parentView:this.get("module").getListView()});var t=this;this.on("sync",function(){t.set("nbObjects",t.get("objectId").length)}).on("change:tracksSettings",function(e,r){t._tracksModule&&t._tracksModule.set("showPoints",r.showPoints),t._tracksModule&&t._tracksModule.set("colorTracks",r.colorTracks),t._tracksModule&&t._tracksModule.set("speedColors",r.speedColors)})},prepareDate:function(e){if("number"==typeof e||e instanceof Date)return Date.sqlFormat(e);if("string"==typeof e)try{return Date.sqlFormat(Date.parse(e))}catch(t){}return e},_prepareDeviceProperties:function(){var e=this.get("properties");"fake"===e?this.set("properties",["extId"]):this.set("properties",t.without(e,"fake")),this.setUserData("properties",this.get("properties"))},getPostParams:function(){var e=this.get("objectId"),t={objectId:e,from:this.prepareDate(this.get("startTime")),to:this.prepareDate(this.get("endTime")),scode:this.get("addrSourceCode")};if(this.has("tzId")?t.tzId=this.get("tzId"):t.tz=App.getUserTimezone(),t.sort=this.get("sort")||"name",this.has("timeRanges")){var r=this.get("timeRanges"),n=[];e.forEach(function(e){n.push({id:e,ranges:r})}),delete t.objectId,delete t.from,delete t.to,t.objectIds=n}return t},buildView:function(){var e=this;return this.trigger("beforerender",this._view),this._view.render().done(function(){e.trigger("afterrender",e._view)}),this._view},getView:function(){return this._view},getTexts:function(){return this._module.getTexts()},getEventsPrefix:function(){return this._module.getEventsPrefix()+"."+this.id},setUserData:function(e,t){var r=this.getUserDataPrefix()+"."+e;return App.getStorage().set(r,t)},getUserData:function(e){var t=this.getUserDataPrefix()+"."+e;return App.getStorage().get(t)},getUserDataPrefix:function(){return this._module.id.replace(/\//g,".")+"."+this.get("key")},makeTracksModule:function(e){if(!this._tracksModule){var r=this.get("tracksSettings"),n=this._tracksModule=new e({id:this._module.id+"/"+this.id+"/tracks",container:!1,parent:this,options:t.extend({},r,{list:!1,mapsModule:this._module.getMapsModule()})});this._tracksModule.listenTo(this,"remove",function(){n.destroy()})}},getTracksModule:function(){return this._tracksModule},buildTrackSegment:function(e){var t=this._module.getTracksSegmentsMode();if("all"!=t&&this._tracksModule.items.remove(this._tracksModule.items.models),this.has("tzId")){var r=App.getTimezone({id:this.get("tzId")}),n=r.offset,i=60*App.getUserTimezone(),a=6e4*(n-i);e.tzId=this.get("tzId"),e.startTime+=a,e.endTime+=a}return this.trigger("buildtrack",null,e),!0},removeTrackSegment:function(e){this._tracksModule.items.remove(e)},searchAddresses:function(e){if(e.length){var t=this,r=this._module,n=this.get("addrSourceCode"),i=e.length;this.clearJsonData();for(var a=0;i>a;++a)r.searchAddress({data:e[a],addrSourceCode:n,success:function(){t._view.onAddressLoad.apply(t._view,arguments)}})}},exportTo:function(r){var n=new e.Deferred;if(-1==t.indexOf(i,r))return n.reject("Unavailable format"),n;var a={xls:"excel",pdf:"pdf"},o=t.isFunction(this.url)?this.url(r):this.url,s=this.getPostParams();return this.readyForExport()?s.jsonData=this._jsonData:s.authorization=App.getBasic(),s.locale=LOCALE,"objectIds"in s&&(s.objectIds=JSON.stringify(s.objectIds)),e.fileDownload(o.replace("reports/","reports/form/")+a[r],{httpMethod:"POST",data:e.param(s)}).done(function(){n.resolve()}).fail(function(){n.reject.apply(n,arguments)}),n},readyForExport:function(){return null!==this._jsonData&&this._jsonData.length&&(!("addressesLoaded"in this)||this.addressesLoaded)},clearJsonData:function(){this._jsonData=null},buildChildReport:function(n,i){var a=JSON.stringify(n);if(i=i||this.get("type"),a in this._children){if(null===this._children[a])return;return this._module.viewReport(this._children[a].id,this.id),void 0}this._children[a]=null;var o={objectId:n,source:this,type:i,_childKey:a};t.each(["tzId","properties","startTime","endTime"],function(e){o[e]=this.get(e)}.bind(this)),this.has("timeRanges")&&(o.timeRanges=this.get("timeRanges")),o=e.extend({},o,this._getChildReportParams()),this.trigger("build:start"),App.trigger("needreport","mobile",o),r.growl.open(this.getTexts().reportBuildingHasStarted)},_getChildReportParams:function(){return{}},registerChild:function(e){var t=JSON.stringify(e.get("objectId"));this.listenToOnce(e,"sync",function(){this._children[t]=e,this.trigger("build:finish")}.bind(this)).listenTo(e,"remove",function(){delete this._children[t]}.bind(this))}});return a}),define("_common/reports/objst/ObjstReport",["underscore","_common/reports/Report"],function(e,t){var r=t.extend({url:App.getBaseUrl()+"reports/OBJST/",constructor:function(){t.apply(this,arguments),this._jsonData=""},initialize:function(){t.prototype.initialize.call(this,this.getViewClass()),this.unset("startTime"),this.unset("endTime"),this.unset("timeFrom"),this.unset("timeTo"),this.unset("dateFrom"),this.unset("dateTo"),this.set("time",(new Date).getTime());var e=this.get("prop")||["extId"],r=this.get("sf")||[];e=[].concat(e),r=[].concat(r),this.set({time:(new Date).getTime(),prop:e,sf:r}),this.setUserData("prop",e),this.setUserData("sf",r)},getPostParams:function(){var r=t.prototype.getPostParams.call(this);return delete r.from,delete r.to,r.properties=[].concat(this.get("prop")?this.get("prop"):[]),r.stateFields=[].concat(this.get("sf")?this.get("sf"):[]),e.isString(r.properties)&&(r.properties=[r.properties]),e.isString(r.stateFields)&&(r.stateFields=[r.stateFields]),r},readyForExport:function(){return!1}});return r}),define("text!_common/reports/tmpl/report.html",[],function(){return'<div class="box-content">\n\n    <!--<div class="rep-header"></div>--><!--/rep-header-->\n\n    <div class="rep-content"></div><!--/rep-content-->\n\n</div><!--/box-content-->\n\n<div class="box-footer rep-footer">\n    <a href="javascript:;" class="export-link" data-id="<%= id %>" data-format="xls"><%= i18n.exportToExcel %></a><br />\n    <a href="javascript:;" class="export-link" data-id="<%= id %>" data-format="pdf"><%= i18n.exportToPdf %></a>\n</div><!--/rep-footer-->'}),define("text!_common/reports/tmpl/reportHeader.html",[],function(){return'<div class="box-header module-header rep-header append prepend">\n    <div class="add-on pull-left">\n        <a href="javascript:;" class="back">\n            <i class="svg-icon svg-icon-arrow-left"></i>\n        </a>\n    </div>\n    <h2><%= title %></h2>\n    <div class="add-on">\n        <a class="btn-delete" href="javascript:;" title="<%= i18n.removeReport %>" data-id="<%= id %>">\n            <i class="svg-icon svg-icon-remove"></i>\n        </a>\n    </div>\n    <div class="add-on">\n        <a class="btn-add" href="javascript:;" title="<%= i18n.build.ucFirst() %> <%= i18n.another %>">\n            <i class="svg-icon svg-icon-plus"></i>\n        </a>\n    </div>\n    <!--<div class="module-settings">\n\n    </div>-->\n</div>\n<div class="fixed-header"></div>'}),define("text!_common/tmpl/itemsList.html",[],function(){return'<div class="items-list">\n<% var limit = Math.min(limit, items.length); for(var i = 0; i < limit; i++) {%>\n<span data-id="<%= items[i].id %>" class="item"><%= items[i].name %></span><% if(i < limit-1) {%>, <% } %>\n<% } %>\n<% if(i < items.length) {%>\n    <span class="other nobr">\n        <%= i18n.andMore.replace(\'#q#\', (items.length - i)).replace("#l#", i18n.objectsLabels[i18n.whichLabels(items.length - i)]) %>\n    </span>\n<% } %>\n</div>'}),define("text!_common/reports/tmpl/reportMeta.html",[],function(){return'<div class="rep-meta selectable">\n    <% if(!_.isUndefined(objectsList)) {%>\n    <%= objectsList %>\n    <% } %>\n\n    <%if(\'undefined\' != typeof startTime && \'undefined\' != typeof endTime) {%>\n        <p class="dates"><%= i18n.reportPeriod %>:\n            <span class="nobr"><%= Date.format(i18n.DateTime.longFormat, startTime) %></span> -\n            <span class="nobr"><%= Date.format(i18n.DateTime.longFormat, endTime) %></span>\n        </p>\n    <% } else if(\'undefined\' != typeof time) {%>\n        <p class="dates">\n            <%= i18n.dataForDate.ucFirst() %>: <%= Date.format(i18n.DateTime.longFormat, time) %>\n        </p>\n    <% } %>\n\n    <% if(!_.isUndefined(zonesStr)) {%>\n    <p class="dates">\n        <%= zonesStr %>\n    </p>\n    <% } %>\n\n    <%if(tzName) {%><p class="dates"><%= tzName %></p><% } %>\n\n</div>'}),define("text!_common/reports/tmpl/table.html",[],function(){return'<table class="rep-table hidden" data-table="<%= index %>">\n    <thead></thead>\n</table>'}),define("text!_common/reports/tmpl/popup.html",[],function(){return'<% if(type== \'fuelChange\') {%>\n<div class="track-info fuel-change-info">\n    <h5><%= name %> [#<%= extId %>]</h5>\n    <ul class="features">\n        <li><%= (delta > 0 ? i18n.filling : i18n.discharge ).ucFirst() %>: <strong><%= delta.toFixed(1) + \' \' + i18n.l %></strong></li>\n        <li data-value="<%= begin %>"><%= beginS %></li>\n        <li><span data-geoid="<%= geoId || 0 %>" class="address"><i class="svg-icon svg-icon-spinner icon-spin"></i>\n            <%- addressStr %>\n        </span></li>\n    </ul>\n</div>\n<% } else if(type== \'accesscard\') { %>\n<div class="<%= className %>"">\n<h5><%= name %> [#<%= extId %>]</h5>\n<ul class="features">\n    <li><%= text.idCard %>: <%= card %></li>\n    <li data-value="date"><%= date %></li>\n    <li><span data-geoid="<%= geoId || 0 %>" class="address"><i class="svg-icon svg-icon-spinner icon-spin"></i>\n            <%= addressStr %>\n        </span></li>\n</ul>\n</div>\n<% } else if(type== \'criticalRpm\') { %>\n<div class="track-info rpm-info">\n    <ul class="features">\n        <li class="nobr">\n            <%= i18n.date.ucFirst() %>/<%= i18n.time.ucFirst() %>:\n            <strong><%= dateS %> <%= startS %></strong>\n        </li>\n        <li class="nobr"><%= i18n.duration %>: <strong><%= timeS %></strong></li>\n        <li><%= i18n.maximum %>: <strong><%= max %> <%= i18n.rpm %></strong></li>\n        <li><%= i18n.avgValue %>: <strong><%= avg %> <%= i18n.rpm %></strong></li>\n    </ul>\n</div>\n<% } else if(type== \'discreteSwitch\') { %>\n<div class="track-info discrete-info">\n    <h5><%= title %></h5>\n    <ul class="features">\n        <li><%= i18n.currentState %>: <strong><%= state %></strong></li>\n        <li class="nobr"><%= i18n.date.ucFirst() %>/<%= i18n.time.ucFirst() %>: <strong><%= start %></strong></li>\n        <li class="nobr"><%= i18n.duration %>: <strong><%= duration %></strong></li>\n    </ul>\n</div>\n<% } else if(type== \'nearestObject\') { %>\n<div class="track-info">\n    <h5><%= title %></h5>\n    <ul class="features">\n        <li class="nobr"><%= i18n.time.ucFirst() %>: <strong><%= timeS %></strong></li>\n        <li><%= i18n.distance %>: <strong><%= distanceS %> <%= i18n.km %></strong></li>\n        <li><%= i18n.speed.ucFirst() %>: <strong><%= speedS %> <%= i18n.kmh %></strong></li>\n    </ul>\n</div>\n<% } else if(type== \'passMatrix\') { %>\n<div class="track-info">\n    <h5><%= title %></h5>\n    <ul class="features">\n        <li class="nobr"><%= i18n.dateAndTime %>: <strong><%= dateS %></strong></li>\n        <li><%= i18n.pass.enteredTotalShort %>: <strong><%= totalIn %></strong></li>\n        <li><%= i18n.pass.exitedTotalShort %>: <strong><%= totalOut %></strong></li>\n    </ul>\n</div>\n<% } %>'
}),define("text!_common/reports/tmpl/pins.svg",[],function(){return'<svg class="svg" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="36" viewBox="0 0 24 36">\n<path class="svg-path svg-pin" d="M12,0C5.366,0,0,5.634,0,12.6C0,22.05,12,36,12,36s12-13.95,12-23.4C24,5.634,18.634,0,12,0z"/>\n<path class="svg-bgr" fill="#FFFFFF" d="M12.001,21.316c-4.969,0-9.001-4.031-9.001-9s4.032-9,9.001-9c4.968,0,8.999,4.032,8.999,9\n	S16.969,21.316,12.001,21.316z"/>\n<% if(type == \'fuel\') {%>\n<path class="svg-path svg-path-fuel" d="M18.084,8.223l-1.499-0.836c-0.37-0.207-0.821-0.04-1.007,0.374c-0.185,0.414-0.035,0.916,0.336,1.122l0.344,0.192\n	c0.034,0.571,0.321,1.063,0.741,1.335v4.833c0,0.23-0.168,0.418-0.375,0.418s-0.375-0.188-0.375-0.418v-3.345\n	c0-1.384-1.009-2.51-2.25-2.51v-2.09c0-0.923-0.672-1.674-1.499-1.674H8.75c-0.827,0-1.5,0.75-1.5,1.674v9.271l-0.53,0.592\n	C6.579,17.318,6.5,17.53,6.5,17.752v0.418c0,0.461,0.336,0.836,0.75,0.836h6.749c0.414,0,0.751-0.375,0.751-0.836v-0.418\n	c0-0.222-0.079-0.435-0.221-0.591l-0.53-0.592v-5.507c0.414,0,0.751,0.374,0.751,0.836v3.345c0,1.153,0.842,2.091,1.874,2.091\n	c0.981,0,1.782-0.85,1.859-1.922c0.011-0.055,0.017-0.111,0.017-0.169V8.971C18.5,8.655,18.338,8.364,18.084,8.223z M12.5,10.644\n	H8.75V8.136h3.75V10.644z"/>\n<% } else if(type == \'engine\') { %>\n	<path class="svg-path svg-path-engine" d="M19.254,10.738h-0.328c-0.137,0-0.247,0.111-0.247,0.247v4.279c0,0.135,0.11,0.246,0.247,0.246h0.328\n	c0.136,0,0.246-0.11,0.246-0.246v-4.279C19.5,10.849,19.39,10.738,19.254,10.738z M4.747,10.53c-0.136,0-0.247,0.11-0.247,0.247\n	v4.697c0,0.136,0.111,0.247,0.247,0.247h0.669c0.136,0,0.247-0.111,0.247-0.247v-4.696c0-0.135-0.111-0.246-0.247-0.246H4.747V10.53\n	z M14.109,16.472c0.55-0.213,1.096-0.433,1.644-0.646c0.049-0.019,0.105-0.025,0.158-0.027c0.405-0.002,0.812-0.002,1.216-0.002\n	c0.42,0,0.689-0.27,0.689-0.695v-1.389c0-0.1,0.081-0.178,0.179-0.178l0.176-0.005c0.139,0,0.146-0.054,0.151-0.15l0.003-0.807\n	c0-0.081-0.064-0.145-0.146-0.145h-0.188c-0.1,0-0.18-0.081-0.18-0.181l0.006-1.685c0.005-0.25-0.097-0.421-0.288-0.559\n	c-0.328-0.237-1.296-0.924-1.454-1.025c-0.108-0.071-0.227-0.099-0.359-0.098L14.048,8.88c-0.143,0-0.258-0.115-0.258-0.257V8.571\n	c0-0.144,0.117-0.261,0.261-0.261h1.513c0.144,0,0.261-0.117,0.261-0.26V7.748c0-0.144-0.117-0.26-0.261-0.26h-5.022\n	c-0.144,0-0.261,0.117-0.261,0.26V8.05c0,0.144,0.117,0.26,0.261,0.26h1.637c0.144,0,0.261,0.117,0.261,0.261v0.06\n	c0,0.142-0.115,0.259-0.26,0.257l-1.653-0.006c-0.315-0.009-0.575,0.098-0.814,0.271C9.361,9.408,9.017,9.67,8.673,9.932\n	c-0.087,0.066-0.196,0.103-0.305,0.101c-0.331-0.003-0.663-0.003-0.995,0c-0.412,0.003-0.678,0.269-0.682,0.682l0.005,1.151\n	c0,0.098-0.079,0.178-0.178,0.178H6.363c-0.188,0-0.34,0.152-0.34,0.34v1.824c0,0.188,0.152,0.339,0.34,0.339h0.149\n	c0.098,0,0.178,0.079,0.178,0.178c0,0.262-0.001,0.75,0,1.033c0,0.262-0.004,0.754,0.476,0.754h6.733\n	C13.971,16.513,14.045,16.499,14.109,16.472z"/>\n    <% } else if(type == \'accesscard\') { %>\n    <rect x="5.5" y="7.5" width="13" height="10" rx="0.5" fill="#FFFFFF" stroke="#009000"/>\n    <rect x="7" y="9" width="4" height="1" fill="#009000"/>\n    <rect x="7" y="12" width="4" height="1" fill="#009000"/>\n    <rect x="7" y="15" width="4" height="1" fill="#009000"/>\n    <rect x="12" y="13" width="5" height="5" rx="1" fill="#009000"/>\n    <circle cx="14.5" cy="10.5" r="1.5" fill="#009000"/>\n<% } else if(type == \'switch\') { %>\n	<path class="svg-path svg-path-switch" d="M5.653,8.992l4.039-4.039l4.039,4.039h-2.885v4.615H8.538V8.992H5.653z M18.347,15.915l-4.039,4.039l-4.039-4.039h2.885\n	v-4.615h2.309v4.615H18.347z"/>\n<% } %>\n</svg>\n'}),define("_common/reports/views/ReportView",["jquery","underscore","jface","moment","util","abstracts/View","text!../tmpl/report.html","text!../tmpl/reportHeader.html","text!_common/tmpl/itemsList.html","text!../tmpl/reportMeta.html","text!../tmpl/table.html","text!../tmpl/popup.html","text!../tmpl/pins.svg"],function(e,t,r,n,i,a,o,s,l,d,c,m,u){o=t.template(o),s=t.template(s),l=t.template(l),d=t.template(d),c=t.template(c),m=t.template(m),u=t.template(u),n.locale(App.getLocale().substr(0,2));var p={FUEL_BAND:"rgba(90,200,30,0.20)",DISCHARGE_BAND:"rgba(210,20,0,0.20)",PARK_BAND:"rgba(140,160,200,0.25)",PARK_IGN_BAND:"rgba(210,210,0,0.25)"},h=a.extend({FIX_HEADER:!0,constructor:function(){this.container=null,this.header=null,this.content=null,this.footer=null,this.table=null,this.fixed=null,this.mobileProps={},this._parentView=null,this._markers=null,this._markerId=0,this._markerData={},this._jsOffset=0,this._tzName="",a.apply(this,arguments)},initialize:function(e){if(!e||!e.container)throw new Error("No container for report view");var t=this;this._i18n=this.model.getTexts(),this.container=e.container,this._parentView=e.parentView;var r=60*App.getUserTimezone();if(this._jsOffset=r,this.model.has("tzId")){var n=App.getTimezone({id:this.model.get("tzId")});this._jsOffset=n.offset,this._jsOffset!=r&&(this._tzName=App.getFullTimezoneName(n))}this.mobileProps={extId:this._i18n.objIdNumber,name:this._i18n.objName,groups:this._i18n.objGroup,carId:this._i18n.licenseNumber,model:this._i18n.objModel,type:this._i18n.vehicleType,vin:this._i18n.objVin,year:this._i18n.objYear,deviceTypeName:this._i18n.objHardwareType},this.listenTo(this.model,"remove",function(){t.stopListening(t.model),t.remove(),t._markers&&t._markers.trigger("destroy"),t._markers=null}).listenTo(this.model,"afterrender",function(e){e.onAfterRender()}),this.listenTo(App,"clearmap",function(e){t.model.get("module").getMapsModule()==e?(t.$el.find(".clear-map-link").addClass("hidden"),App.trigger("clearmap",t.model.getTracksModule())):t.model.getTracksModule()==e&&t._markers&&t._markers.trigger("destroy")&&(t._markers=null)}),this.$el.data("id",this.model.id)},bindScrollEvents:function(){this.$el.find(".box-content").on("scroll",t.bind(t.throttle(this.onReportScroll,60),this)),this.listenTo(this.model,"resizepane",t.bind(t.throttle(this.onResizePane,60),this))},unBindScrollEvents:function(){this.$el.find(".box-content").off("scroll"),this.stopListening(this.model,"resizepane")},render:function(){this.$el.append(s({id:this.model.id,title:this.model.get("name"),i18n:this._i18n})).append(o({id:this.model.id,i18n:this._i18n})).appendTo(this.container),this.header=this.$el.find(".rep-header"),this.content=this.$el.find(".rep-content"),this.footer=this.$el.find(".rep-footer"),"Blob"in window||this.footer.find(".export-link").remove()},onAfterRender:function(){this.FIX_HEADER&&(this._createHeaderClones(),this.bindScrollEvents()),r.growl.open(this.model.get("name")+" "+this._i18n.hasBeenBuilt)},putFuelMarker:function(e){if(e){var t=this.putMarkers([e],{icon:new L.PinIcon({html:u({type:"fuel"}),addClassName:"fuel-marker "+(e.delta<0?" negative":"")}),popup:{type:"fuelChange",className:"track-info fuel-change-info"+(e.delta<0?" negative":""),offset:[0,-25]},zoom:!0});return t}},putMarkers:function(e,t){if(e.length){var r,n,i,a,o=this.model.get("module").getMapsModule(),s=[],l=[[90,180],[-90,-180]];this._buildMarkersLayer(t);for(var d=0,c=e.length;c>d;++d)r=e[d],r.lat&&r.lon&&(a=r.lon,i=r.lat,t.zoom&&(i>l[1][0]&&(l[1][0]=i),i<l[0][0]&&(l[0][0]=i),a>l[1][1]&&(l[1][1]=a),a<l[0][1]&&(l[0][1]=a)),n=o.buildMarker({lat:i,lon:a,icon:t.icon||null,className:t.className||"",data:r}),this.bindPopup(n,{data:r,options:t}),s.push(n));return this._markers.addLayers(s),t.zoom&&o.fitBounds(l),s}},bindPopup:function(r,n){var i=this,a=n.data,o=n.options;r.bindPopup(function(){if(o.popup&&o.popup.wraperClassName){var r=this.getContainer();e(r).addClass(o.popup.wraperClassName)}return m(t.extend({},a,o.popup,{beginS:"begin"in a?i.formatDateTime(a.begin):"",addressStr:a.address?a.address:Math._round(a.lat,4)+", "+Math._round(a.lon,4),i18n:i._i18n}))},o.popup)},hide:function(){this.unBindScrollEvents(),this.$el.addClass("hidden"),this.model._tracksModule&&this.model._tracksModule.hideAll(),this._markers&&this._markers.trigger("hide")},show:function(){this.$el.removeClass("hidden"),this.model._tracksModule&&this.model._tracksModule.showAll(),this._markers&&this._markers.trigger("show"),this.bindScrollEvents(),this._copyWidth()},buildMetaInfo:function(){this.content&&(this.model.getTexts(),this.content.append(this._renderMetaInfo()))},getZoneStr:function(){var e=this.model.getTexts(),t=void 0,r=this.model.get("header");return r&&r.zones&&(t=e.geofenceViolations+": ",r.zones.forEach(function(e,n){e.name&&(t+=e.name),n<r.zones.length-1&&(t+=", ")})),t},_renderMetaInfo:function(){var e=this.model.getTexts(),t=this.getZoneStr();return d({objectsList:this._renderObjectsList(),startTime:this.model.get("startTime"),endTime:this.model.get("endTime"),tzName:this._tzName,zonesStr:t,i18n:e})},_renderObjectsList:function(){var e=this.model.getTexts();return l({items:this.model.get("items"),i18n:e,limit:3})},_buildMarkersLayer:function(e){var t=this.model.get("module").getMapsModule();this._markers||(e=e||{},this._markers=t.addLayersGroup({layers:[],clusters:!1,popup:e.popup||!1,events:e.events||!1}))},_initMarkersLinks:function(t){var r=this;this.content.on("click",".put-marker",function(){var n=e(this),i=n.data("id"),a=n.closest(".report");return i in r._markerData&&(a.find(".clear-map-link").removeClass("hidden"),t.call(r,r._markerData[i])),!1})},getDaysPeriods:function(e,t){var r="",i={},a=n(e*App.MS).utcOffset(this._jsOffset),o="YYYY-MM-DDT00:00:00";o+=Date.offsetToString(this._jsOffset);var s,l=n(a.format(o)),d=l.valueOf()/App.MS,c=null;for(this.model.has("filterDays")&&(c=this.model.get("filterDays"));t>d;)r=d.toExponential().toUpperCase().replace("+",""),null!==c?(s=new Date(1e3*d).getDay(),c.indexOf(0===s?7:s)>=0&&(i[r]=d)):i[r]=d,d+=86400;return i},formatDistance:function(e){return new Number(e).toFixed(2)},formatUTC:function(e,t){var r=n(t).utcOffset(this._jsOffset);return r.format(e,t)},formatDateTime:function(e){return this.formatUTC("DD.MM.YYYY HH:mm:ss",e instanceof Date?e:e*App.MS)},formatDate:function(e){return this.formatUTC("DD.MM.YYYY",e instanceof Date?e:e*App.MS)},formatTime:function(e){return this.formatUTC("HH:mm:ss",e instanceof Date?e:e*App.MS)},formatSeconds:function(e){return Date.formatSeconds(e)},getDayOfWeek:function(e){return this.formatUTC("dddd",e instanceof Date?e:e*App.MS)},isWeekend:function(e){return this.formatUTC("E",e instanceof Date?e:e*App.MS)>5},buildObjectTitleByProperties:function(e){var r="";if(e.name)r=e.name;else{var n=[];t.each(["type","model","licenseNumber"],function(t){e[t]&&n.push(e[t])}),r=n.join(", ")}return e.extId&&(r=r.length?r+" (#"+e.extId+")":"#"+e.extId),r||"noname"},_getOffsetTop:function(e){var t=0;if(e)for(;!(null==e||e.hasAttribute("class")&&e.getAttribute("class").match(/box-content/));)t+=e.offsetTop,e=e.offsetParent;return t},_copyWidth:function(){if(this.headers&&this.headers[0]){var r;t.each(this.headers,function(t){t.$origin.each(function(n){t.$clone&&(r=e(t.$clone.get(n)).find("th"),e(this).find("th").each(function(t){e(r.get(t)).width(e(this).width())}))})}),this.$el.find(".fixed-header").width(this.headers[0].$origin.closest("table").width())}},_createHeaderClones:function(){var r,n=this,i=this.$el.find(".fixed-header"),a=0,o=[];i.html(""),this.$el.find("tr[data-head]").each(function(){this.getAttribute("data-head")==a?o[o.length-1].$origin=o[o.length-1].$origin.add(this):(a++,o.push({$clone:null,$origin:e(this),index:a,first:null,last:null,top:0,bottom:0}))}),t.each(o,function(e){e.first=e.$origin.first().get(0),e.last=e.$origin.last().nextAll("[data-row=last]").first().get(0),e.last&&e.first&&(e.top=n._getOffsetTop(e.first),e.bottom=n._getOffsetTop(e.last)+e.last.offsetHeight,i.append(c({index:e.index})),r=i.find("[data-table="+e.index+"] thead"),r.append(e.$origin.clone()),e.$clone=r.find("tr"))}),this.headers=o,this._copyWidth()},defineVisibilities:function(){if(this.headers){var e=this,r=this.$el.find(".box-content"),n=r.get(0).scrollTop;t.each(this.headers,function(t){t.first&&t.last&&(t.top=e._getOffsetTop(t.first),t.bottom=e._getOffsetTop(t.last)+t.last.offsetHeight,n>t.top&&n<t.bottom?t.$clone.closest("table").removeClass("hidden"):t.$clone.closest("table").addClass("hidden"))})}},onReportScroll:function(){this.defineVisibilities()},onResizePane:function(){this.headers&&(this._copyWidth(),this.defineVisibilities())},onAddressLoad:function(e,t){if(!t.geoId)return!1;for(var r=this.$el.find(".loading-address[data-geoid="+t.geoId+"]"),n=e&&e.address||this._i18n.addressNotFound,i=r.length,a=n.indexOf(this._i18n.addressNotFound)>-1;i--;)if(a){var o=r[i].parentNode,s=parseFloat(o.dataset.lat).toFixed(6),l=parseFloat(o.dataset.lon).toFixed(6),d=this._i18n.addressNotFound+" ["+s+","+l+"]";o.innerHTML=d}else r[i].parentNode.innerHTML=n},_getChartColors:function(){return p},_prepareWideReportFixedHeader:function(){var e=this.content.find("tbody"),t=this.$el.find(".box-content"),r=this.$el.find(".fixed-header");e.width()<t.width()?this.$el.find(".rep-table").width("100%"):(r.prependTo(t),r[0].style.margin="0px",t.on("scroll",function(){r[0].style.top=t[0].scrollTop+"px"}))},_initAddressesRequests:function(){var t=this.model,r=t.getTexts();this.content.on("click",".load-address",function(n){var i=e(this),a=i.data("geoid");return n.stopPropagation(),a?(i.removeClass("load-address").addClass("loading-address").text(r.loadingAddress),t.searchAddresses([{geoId:a,lat:i.data("lat"),lon:i.data("lon")}])):i.replaceWith("<span>"+r.error+"</span>"),!1})}});return h}),define("text!_common/reports/objst/tmpl/reportMeta.html",[],function(){return'<div class="rep-meta selectable">\n    <% if(!_.isUndefined(objectsList)) {%>\n    <%= objectsList %>\n    <% } %>\n\n    <p class="dates"><%= i18n.dataForDate.ucFirst() %>: <%= Date.format(i18n.DateTime.longFormat, time) %></p>\n    <%if(tzName) {%><p class="dates"><%= tzName %></p><% } %>\n    <p><%= i18n.nObjectsSelected[i18n.whichLabels(nbObjects)].replace(\'#n#\', nbObjects) %></p>\n\n</div>'}),define("text!_common/reports/objst/tmpl/controls.html",[],function(){return'<div class="rep-table-controls form-horizontal">\n    <% if(sortFields) { %>\n    <div class="control-group">\n        <label class="control-label"><%= i18n.sort %></label>\n        <select class="form-control" name="sort">\n            <% _.each(sortFields, function(key) {%>\n            <option value="<%= key %>"<% if(key == curSortField) {%> selected<% } %>><%= names[key] %></option>\n            <% }) %>\n        </select>\n        <select class="form-control" name="sortType">\n            <option value="asc"<% if(\'asc\' == curSortType) {%> selected<% } %>><%= i18n.sortTypeAsc %></option>\n            <option value="desc"<% if(\'desc\' == curSortType) {%> selected<% } %>><%= i18n.sortTypeDesc %></option>\n        </select>\n    </div>\n    <% } %>\n    <% if(groupFields) { %>\n    <div class="control-group">\n        <label class="control-label"><%= i18n.groupBy %></label>\n        <select class="form-control" name="group">\n            <option value=""><%= i18n.no.ucFirst() %></option>\n            <% _.each(groupFields, function(key) {%>\n            <option value="<%= key %>"<% if(key == curGroupField) {%> selected<% } %>><%= names[key] %></option>\n            <% }) %>\n        </select>\n    </div>\n    <% } %>\n</div>'}),define("text!_common/reports/tmpl/reportTable.html",[],function(){return"<table class=\"selectable rep-table<%if(!_.isUndefined(key)) {%> <%- key %>-rep-table<% } %>\">\n    <%if('undefined' != typeof theadHtml) {%>\n    <thead class=\"rep-table-head header-copy\">\n    <%= theadHtml %>\n    </thead>\n    <% } %>\n    <tbody><%if('undefined' != typeof tbodyHtml) { print(tbodyHtml) } %></tbody>\n</table><!-- /rep-table -->"}),define("text!_common/reports/objst/tmpl/thead.html",[],function(){return'<tr data-head="1">\n    <% for(var i = 0, l = fields.length; i < l; i++) { %>\n    <th data-key="<%= fields[i] %>"><%= names[fields[i]] %></th>\n    <% } %>\n</tr>'}),define("text!_common/reports/objst/tmpl/rowGroup.html",[],function(){return'<tr>\n    <td class="row-group" colspan="<%= colspan %>"><%= label %> (<%= nb %>)</td>\n</tr>'}),define("_common/reports/objst/views/ObjstReportView",["jquery","underscore","abstracts/Model","_common/reports/views/ReportView","text!_common/tmpl/itemsList.html","text!../tmpl/reportMeta.html","text!../tmpl/controls.html","text!_common/reports/tmpl/reportTable.html","text!../tmpl/thead.html","text!../tmpl/rowGroup.html"],function(e,t,r,n,i,a,o,s,l,d){i=t.template(i),a=t.template(a),o=t.template(o),s=t.template(s),l=t.template(l),d=t.template(d);var c=n.prototype,m=n.extend({constructor:function(){this.names={},this.fields={},this.hasControls=!1,this.sortFields={},this.curSortField=!1,this.curSortType="asc",this.groupFields={},this.curGroupField=!1,this.$tbody=null,n.apply(this,arguments)},initialize:function(){var e=this.model;this._setNames(),this._setStatusNames(),this.fields=t.union(e.get("prop")||[],e.get("sf")||[]),this._setGroupFields(),this._setSortFields();var r=this.sortFields;if(e.get("items").length>1&&(r.length||this.groupFields.length)){var n=e.get("sort");this.hasControls=!0,this.curSortField=r.indexOf(n)<0?r[0]:n}c.initialize.apply(this,arguments)},render:function(){var t=new e.Deferred,r=this.model,n=r.getTexts();c.render.apply(this,arguments),this.$el.addClass("objst-report"),this.buildMetaInfo();var i=this._renderRows();return i?(this.hasControls&&(this.content.append(this._renderControls()),this._initControls()),this.content.append(s({key:r.get("key"),theadHtml:""})),this.$tbody=this.content.find("tbody"),this.$tbody.append(i),this._makeExternalLinks.call(this,this.$tbody.find('td[data-key="comment"], td[data-key="extraHardware"]')),this.content.append(this._renderSummary())):this.content.append('<p class="no-data">'+n.noObjectsWithFaultsForReport+"<p>"),t.resolve(),t},buildMetaInfo:function(){if(this.content){var e=this.model.get("items"),t=this.model.getTexts();this.content.append(a({objectsList:i({items:e,i18n:t,limit:3}),nbObjects:e.length,time:this.model.get("time"),tzName:this._tzName,i18n:t}))}},_setNames:function(){var e=this.model.getTexts();this.names={extId:e.objIdNumber,name:e.objName,status:e.objStatus,shortDescription:e.description,address:e.address.ucFirst(),groups:e.objGroup,sim:e.simCard+" 1",sim1Provider:e.gsmProvider+" 1",sim2:e.simCard+" 2",sim2Provider:e.gsmProvider+" 2",pass:e.objServerPassword,imei:"IMEI",rev:e.rev,gsmTime:e.timeOfLastAlert,comment:e.comments.ucFirst(),extraHardware:e.objExtraHardware}},_setStatusNames:function(){var e=this.model.getTexts();this.statusNames={0:e.objNotServed,1:e.objServed,2:e.service,4:e.alertsControl}},_getStatusName:function(e){return this.statusNames&&this.statusNames[e]||""},_getGroupPossibleFields:function(){return["groups","sim1Provider","sim2Provider","rev"]},_setGroupFields:function(){var e=this.fields,t=this._getGroupPossibleFields(),r=[];t.forEach(function(t){-1!=e.indexOf(t)&&r.push(t)}),this.groupFields=r},_getSortPossibleFields:function(){return["extId","name","gsmTime","equipmentIds"]},_setSortFields:function(){var e=this.fields,t=this._getSortPossibleFields(),r=[];t.forEach(function(t){-1!=e.indexOf(t)&&r.push(t)}),this.sortFields=r},_getSelected:function(){return{}},_renderHead:function(){return l({i18n:this.model.getTexts(),fields:this.fields,names:this.names})},_renderControls:function(){var e=this.sortFields.length?this.sortFields:!1,t=this.groupFields.length?this.groupFields:!1,r=this.model.getTexts();return o({sortFields:e,curSortField:this.curSortField,curSortType:this.curSortType,groupFields:t,curGroupField:this.curGroupField,names:this.names,i18n:r})},_initControls:function(){var e=this,t=this.content.find("select[name=sort]"),r=this.content.find("select[name=sortType]"),n=this.content.find("select[name=group]");t.on("change",function(){e.curSortField=t.val(),e._rerender()}),r.on("change",function(){e.curSortType=r.val(),e._rerender()}),n.on("change",function(){e.curGroupField=n.val(),e._rerender()})},_rerender:function(){this.$tbody.html(this._renderRows()),this._makeExternalLinks.call(this,this.$tbody.find('td[data-key="comment"], td[data-key="extraHardware"]')),this._createHeaderClones()},_renderRows:function(){var e=this.model.get("body"),r=t.keys(e).length;if(!r)return!1;var n=this._renderHead(),i=0,a=this._groupAndSortData();if(this.curGroupField){var o=this.fields.length;t.each(a,function(e){n+=d({colspan:o,label:this._getGroupLabel(e.key),nb:e.rows.length}),n+=this._renderSortedRows(e.rows,function(){return++i==r})}.bind(this))}else n+=this._renderSortedRows(a,function(){return++i==r});return n},_getGroupLabel:function(e){return this.names[this.curGroupField]+": "+e},_renderSortedRows:function(){return""},_renderSummary:function(){return""},_groupAndSortData:function(){var e=this.model,r=e.get("body"),n=[];if(this.hasControls){var i=this.curSortField,a=this.curGroupField;if(a){var o,s={},l=this.model.getTexts(),d=[],c=l.noData.ucFirst();t.each(r,function(e){o=this._getGroupValue(e,a),o.length?(s[o]=s[o]||[],s[o].push(e)):d.push(e)}.bind(this)),t.each(s,function(e,t){n.push({key:t,rows:this._sortData(e,i)})}.bind(this)),n=t.sortBy(n,function(e){return e.key.toLowerCase()}),d.length&&n.push({key:c,rows:this._sortData(d,i)})}else n=this._sortData(r,i)}else{var m=e.get("header").keyOrder;t.each(m,function(e){n.push(r[e])})}return n},_getGroupValue:function(e,t){return t in e?String(e[t]).trim():""},_sortData:function(e,r){var n=t.sortBy(e,function(e){return this._getSortValue(e,r)}.bind(this));return"desc"==this.curSortType?n.reverse():n},_getSortValue:function(e,t){var r=e[t]||"",n=this.curSortType;switch(t){case"extId":r=parseInt(r);break;case"gpsTime":case"gsmTime":r=r||("asc"==n?+new Date(2200,0,1):-1);break;default:r=r.toLowerCase()}return r},_prepareRowData:function(e){return{fields:this.fields,obj:this._getSelected(e),rowClass:"",isLast:!1}},_makeExternalLinks:function(e){var r=/(https?:\/\/\S+)/gi,n=new RegExp("\\n","gi"),i='<a class="link" target="_blank" href="$1">$1</a>',a="<br/>";e.each(function(){var e=this.innerHTML.trim(),o=t.escape(e);o=o.replace(n,a),o=o.replace(r,i),this.innerHTML=o})}});return m}),define("text!stat/reports/objst/tmpl/row.html",[],function(){return'<tr class="<%= rowClass %>"<% if(isLast) { %> data-row="last"<% } %>>\n<% for(var field in obj) { %>\n<td class="colObjst" data-key="<%= field %>" data-value="<%= obj[field] %>">\n    <% if(field == \'address\') { %>\n    <% if(obj.address) {print(obj.address)} else { %>\n    --\n    <% } %>\n    <% } else { print(obj[field]); } %>\n</td>\n<% } %>\n</tr>'}),define("text!stat/reports/objst/tmpl/summary.html",[],function(){return'<h3 class="report-objst-summary"><%= i18n.summary %></h3>\n<ul class="summary">\n    <% if(typeof data.gsm != \'undefined\'){ %>\n    <li class="summary-item">\n        <table>\n            <tr>\n                <td class="title" colspan="3"><%= i18n.objectReport.connection %></td>\n            </tr>\n            <tr>\n                <td class="summary-cell"><%= i18n.objectReport.set %></td>\n                <td class="summary-cell"><%= data.gsm %></td>\n                <td class="summary-cell"><%= Math.round( 100 * data.gsm / count ) %>%</td>\n            </tr>\n            <tr>\n                <td class="summary-cell"><%= i18n.objectReport.notSet %></td>\n                <td class="summary-cell"><%= count - data.gsm %></td>\n                <td class="summary-cell"><%= Math.round( 100 * (count - data.gsm) / count ) %>%</td>\n            </tr>\n        </table>\n    </li>\n    <% } %>\n\n    <% if(typeof data.power != \'undefined\'){ %>\n    <li class="summary-item">\n        <table>\n            <tr>\n                <td class="title" colspan="3"><%= i18n.objectReport.power %></td>\n            </tr>\n            <tr>\n                <td class="summary-cell"><%= i18n.normalValue %></td>\n                <td class="summary-cell"><%= data.power %></td>\n                <td class="summary-cell"><%= Math.round( 100 * data.power / count ) %>%</td>\n            </tr>\n            <tr>\n                <td class="summary-cell"><%= i18n.objectReport.no %></td>\n                <td class="summary-cell"><%= count - data.power %></td>\n                <td class="summary-cell"><%= Math.round( 100 * ( count - data.power ) / count ) %>%</td>\n            </tr>\n        </table>\n    </li>\n    <% } %>\n\n</ul>'}),define("stat/reports/objst/views/ObjstReportView",["jquery","underscore","abstracts/Model","_common/reports/objst/views/ObjstReportView","text!stat/reports/objst/tmpl/row.html","text!stat/reports/objst/tmpl/summary.html"],function(e,t,r,n,i){function a(e){try{return JSON.parse(e).join(", ")}catch(t){return e}}i=t.template(i);var o=n.prototype,s=n.extend({constructor:function(){n.apply(this,arguments)},_setNames:function(){var e=this.model.getTexts();o._setNames.call(this),t.extend(this.names,{gsmTime:e.timeOfLastAlert,equipmentIds:e.objEquipmentIds})},_getSelected:function(e){for(var t=this.fields,r={},n="",i=null,o=this.model.getTexts(),s=0,l=t.length;l>s;s++){switch(n=t[s],i=e[n],n){case"status":i=this._getStatusName(i);break;case"gsmTime":i=i?this.formatDateTime(i):o.objectReport.missing;break;case"equipmentIds":i=i?a(i):""}r[t[s]]=i}return r},_renderSortedRows:function(e,t){for(var r,n,a="",o=0,s=e.length;s>o;++o)r=e[o],r.address=r.address||"-",n=this._prepareRowData(r),n.isLast=t(),a+=i(n);return a}});return s}),define("stat/reports/objst/ObjstReport",["underscore","_common/reports/objst/ObjstReport","./views/ObjstReportView"],function(e,t,r){var n=t.prototype,i=t.extend({url:App.getBaseUrl()+"reports/OBJST/",constructor:function(){t.apply(this,arguments),this._jsonData=""},initialize:function(){n.initialize.call(this),24*60*this.get("alerts_days")+60*this.get("alerts_hours")+this.get("alerts_minutes")<10&&(this.set("alerts_days",0),this.set("alerts_hours",0),this.set("alerts_minutes",10)),this.setUserData("noAlertsMinutes",!!this.get("noAlertsMinutes")),this.setUserData("alerts_days",this.get("alerts_days")),this.setUserData("alerts_hours",this.get("alerts_hours")),this.setUserData("alerts_minutes",this.get("alerts_minutes"))},getViewClass:function(){return r},getPostParams:function(){var t=n.getPostParams.call(this);return e.isString(this.get("noAlertsMinutes"))&&(t.noGsmMinutes=Math.max(10,24*60*this.get("alerts_days")+60*this.get("alerts_hours")+this.get("alerts_minutes"))),t.objType=App.TYPE_STAT,t}});return i}),define("text!_common/reports/alertssummary/tmpl/thead.html",[],function(){return'<tr data-head="<%= headPosition %>">\n    <th data-key="extId"><%= i18n.objIdNumberShort %></th>\n    <th data-key="name"><%= i18n.objName %></th>\n    <% if(reportSubtype === \'general\') { %>\n    <th data-key="alarms"><%= i18n.alarms.ucFirst() %></th>\n    <th data-key="alerts"><%= i18n.alerts.ucFirst() %></th>\n    <th data-key="total"><%= i18n.totalLabel %></th>\n    <% } else { %>\n    <th data-key="total"><%= i18n.quantityAsNumber %></th>\n    <% } %>\n</tr>'}),define("text!_common/reports/alertssummary/tmpl/groupsThead.html",[],function(){return'<tr data-head="<%= headPosition %>">\n    <th><%= i18n.alertsGroup %></th>\n    <th><%= i18n.quantityAsNumber %></th>\n</tr>'}),define("text!_common/reports/alertssummary/tmpl/alertsThead.html",[],function(){return'<tr data-head="<%= headPosition %>">\n    <th><%= i18n.alertCode %></th>\n    <th><%= i18n.alertMessage %></th>\n    <th><%= i18n.quantityAsNumber %></th>\n</tr>'}),define("text!_common/reports/alertssummary/tmpl/channelsThead.html",[],function(){return'<tr data-head="<%= headPosition %>">\n    <th><%= i18n.streamChannel %></th>\n    <th><%= i18n.quantityAsNumber %></th>\n</tr>'}),define("text!_common/reports/tmpl/day.html",[],function(){return'<tr<% if(typeof rowPosition != \'undefined\') { %> data-row="<%= rowPosition %>"<% } %>>\n    <td class="day<% if(isWeekend) {%> weekend<% } %>" colspan="<%=colspan || 20%>"><%=dateStr%></td>\n</tr>'}),define("text!_common/reports/alertssummary/tmpl/row.html",[],function(){return'<tr>\n    <td data-key="extId"><%= extId %></td>\n    <td data-key="name" class="text-left">\n    <% if(total && App.reportAllowedByType(\'ALERTS\')) {%>\n        <a href="javascript:;" class="build-another" data-type="alerts" title="<%= allAlertsOnObject %>"\n            data-id="<%= id %>" data-from="<%= periodStart %>" data-to="<%= periodEnd %>">\n            <%= name %>\n        </a>\n    <% } else { %>\n        <%= name %>\n    <% } %>\n    </td>\n    <% if(reportSubtype === \'general\') { %>\n    <td data-key="alarms"><%= alarms %></td>\n    <td data-key="alerts"><%= alerts %></td>\n    <td data-key="total"><%= total %></td>\n    <% } else { %>\n    <td data-key="total"><%= total %></td>\n    <% } %>\n</tr>'}),define("text!_common/reports/alertssummary/tmpl/groupRow.html",[],function(){return'<tr>\n    <td class="text-left">\n        <%= groupName %>\n    </td>\n    <td>\n        <%= count %>\n    </td>\n</tr>'}),define("text!_common/reports/alertssummary/tmpl/alertRow.html",[],function(){return'<tr>\n    <td class="text-left">\n        <%= String(alertCode).length === 4 ? alertCode / 10 : alertCode %>\n    </td>\n    <td class="text-left">\n        <%= alertName %>\n    </td>\n    <td>\n        <%= count %>\n    </td>\n</tr>'}),define("text!_common/reports/alertssummary/tmpl/channelRow.html",[],function(){return'<tr>\n    <td class="text-left">\n        <%= channelName %>\n    </td>\n    <td>\n        <%= count %>\n    </td>\n</tr>'}),define("text!_common/reports/alertssummary/tmpl/totalsRow.html",[],function(){return'<tr<% if(last) {%> data-row="last"<% } %> class="summary-row">\n    <th colspan="<%= colspan %>" class="text-left"><%= totalText %></th>\n    <% if(isGeneral) { %>\n    <th><%= data.total.alarms %></th>\n    <th><%= data.total.alerts %></th>\n    <th><%= data.total.alarms + data.total.alerts %></th>\n    <% } else { %>\n    <th><%= \'undefined\' === typeof data.totalCount ? data.total.alerts : data.totalCount %></th>\n    <% } %>\n</tr>'}),define("text!_common/reports/alertssummary/tmpl/summary.html",[],function(){return'<div class="summary">\n    <h3><%= i18n.summaryData %></h3>\n    <%= controls %>\n    <table class="rep-table">\n        <thead data-head="2">\n            <%= thead %>\n        </thead>\n        <tbody>\n            <%= tbody %>\n        </tbody>\n    </table>\n</div>'}),define("text!_common/reports/alertssummary/tmpl/controls.html",[],function(){return'<div class="rep-table-controls form-horizontal">\n    <div class="control-group">\n        <label class="control-label"><%= i18n.sort %></label>\n        <select class="form-control" name="sort">\n            <% _.each(sortFields, function(name, key) {%>\n            <option value="<%= key %>"<% if(key == curSortField) {%> selected<% } %>><%= name %></option>\n            <% }) %>\n        </select>\n        <select class="form-control" name="sortType">\n            <option value="asc"<% if(\'asc\' == curSortType) {%> selected<% } %>><%= i18n.sortTypeAsc %></option>\n            <option value="desc"<% if(\'desc\' == curSortType) {%> selected<% } %>><%= i18n.sortTypeDesc %></option>\n        </select>\n    </div>\n</div>'}),define("_common/reports/alertssummary/views/AlertssummaryReportView",["jquery","underscore","_common/reports/views/ReportView","text!_common/reports/tmpl/reportTable.html","text!../tmpl/thead.html","text!../tmpl/groupsThead.html","text!../tmpl/alertsThead.html","text!../tmpl/channelsThead.html","text!_common/reports/tmpl/day.html","text!../tmpl/row.html","text!../tmpl/groupRow.html","text!../tmpl/alertRow.html","text!../tmpl/channelRow.html","text!../tmpl/totalsRow.html","text!../tmpl/summary.html","text!../tmpl/controls.html"],function(e,t,r,n,i,a,o,s,l,d,c,m,u,p,h,f){function g(e){return'<tr><td class="text-left" colspan="'+e.colspan+'">'+e.text+"</td></tr>"}function v(e){switch(e){case"groups":return a;case"alerts":return o;case"channels":return s;default:return i}}function b(e){switch(e){case"groups":return c;
case"alerts":return m;case"channels":return u;default:return d}}function y(e){return"general"===e}function S(e){return!/^groups|alerts|channels$/.test(e)}n=t.template(n),i=t.template(i),a=t.template(a),o=t.template(o),s=t.template(s),l=t.template(l),d=t.template(d),c=t.template(c),m=t.template(m),u=t.template(u),p=t.template(p),h=t.template(h),f=t.template(f);var T=r.extend({constructor:function(){this.sortFields={},this.curSortField="name",this.curSortType="asc",this.sumData=[],this.$sumTbody=null,r.apply(this,arguments)},render:function(){var t=new e.Deferred,i=this.model.getTexts(),a=this.model.get("reportSubtype"),o=S(a);r.prototype.render.apply(this,arguments),this.$el.addClass("alerts-report").attr("data-subtype",a),this._renderSubheader(),this.buildMetaInfo();var s="";if(this.model.get("showDetails")){this.content.append(n({key:this.model.get("key"),theadHtml:""})),s+=v(a)({i18n:i,headPosition:1,reportSubtype:a}),s+=o?this._renderRowsByObjects():this._renderRowsByGroupsAlertsOrChannels();var l=this.content.find("tbody");l.append(s)}var d={name:i.objName,extId:i.objIdNumber};return y(a)?(d.alarms=i.alarms.ucFirst(),d.alerts=i.alerts.ucFirst(),d.total=i.totalLabel):d.total=i.quantityAsNumber,this.sortFields=d,this.content.append(this._buildSummary()),this.$sumTbody=this.content.find(".summary tbody"),o&&this._initControls(),t.resolve(),t},_renderSubheader:function(){var e=this.model.getTexts().alertsSummaryReport,t=this.model.get("reportSubtype");this.content.append('<h3 class="rep-subheader">'+e[t]+"</h3>")},_renderRowsByGroupsAlertsOrChannels:function(){var e,r=this,n=this.model,i=n.getTexts(),a=n.getTexts().noAlerts,o=n.get("reportSubtype"),s=n.get("body").historyDays,d=s.length,c="alerts"===o?3:2,m=b(o),u="",h=0;return t.each(s,function(n){e=n.dayTs,u+=l({colspan:c,dateStr:r.formatDate(e)+" ("+r.getDayOfWeek(e)+")",isWeekend:r.isWeekend(e)}),n.data.length?(t.each(n.data,function(e){u+=m(e)}),u+=p({totalText:i.totalLabel,last:++h===d,colspan:c-1,isGeneral:!1,data:{totalCount:n.totalCount}})):u+=g({colspan:c,text:a})}),u},_renderRowsByObjects:function(){var e,r,n=this,i=this.model.get("header"),a=i.keyOrder,o=this.model.get("body"),s=this.model.get("reportSubtype"),c="general"===s,m={},u="",h=this.model.getTexts(),f=0,g=0,v=this.getDaysPeriods(i.sd,i.ed),b=t.keys(v).length,y=0;return t.each(v,function(t,v){u+=l({colspan:c?5:3,dateStr:n.formatDate(t)+" ("+n.getDayOfWeek(t)+")",isWeekend:n.isWeekend(t)}),f=0,g=0;for(var S=0,T=a.length;T>S;++S)e=a[S],r=o[e],v in r?(m=r[v],m.total=m.alerts+(c?m.alarms:0),m.total&&(m.periodStart=Math.max(t,i.sd)*App.MS,m.periodEnd=Math.min(m.periodStart+86400*App.MS,i.ed*App.MS)),c&&(f+=m.alarms),g+=m.alerts):m={alerts:0,alarms:0,total:0},m.id=r.id,m.name=r.name,m.extId=r.extId,m.allAlertsOnObject=h.allAlertsOnObject,m.reportSubtype=s,u+=d(m);u+=p({totalText:h.totalLabel,last:++y===b,colspan:2,isGeneral:c,data:{total:{alarms:f,alerts:g},totalCount:f+g}})}),u},_buildSummary:function(){var e=this.model.getTexts(),r=this.model.get("reportSubtype"),n=this.model.get("footer"),i=S(r),a=v(r)({headPosition:2,i18n:e,reportSubtype:r});if(i)this.sumData=t.values(t.omit(n,"total")).map(function(e){return Object.assign(e,{total:e.alerts+(y(r)?e.alarms:0)})});else if(this.sumData=n.data,!n.totalCount)return this.model.get("showDetails")?"":'<p class="no-data">'+e.noAlerts+"</p>";return h({i18n:e,controls:i?this._renderControls():"",thead:a,tbody:this._renderSummaryRows()})},_renderSummaryRows:function(){return S(this.model.get("reportSubtype"))?this._renderSummaryRowsByObjects():this._renderSummaryRowsByGroupsAlertsOrChannels()},_renderSummaryRowsByGroupsAlertsOrChannels:function(){this.model.getTexts();for(var e=this.model.get("footer").data,t=this.model.get("reportSubtype"),r=b(t),n="",i=0,a=e.length;a>i;++i)n+=r(e[i]);return n+=this._renderTotalsRow()},_renderSummaryRowsByObjects:function(){for(var e,r=this.model.getTexts(),n=this.model.get("header"),i=this.model.get("reportSubtype"),a="general"===i,o=this._sortData(),s="",l=0,c=o.length;c>l;++l)e=o[l],s+=d(t.extend(e,{allAlertsOnObject:r.allAlertsOnObject,total:e.alerts+(a?e.alarms:0),periodStart:n.sd*App.MS,periodEnd:n.ed*App.MS,reportSubtype:i}));return s+=this._renderTotalsRow()},_renderTotalsRow:function(){var e=this.model.get("reportSubtype");return p({totalText:this.model.getTexts().totalLabel,data:this.model.get("footer"),isGeneral:y(e),last:!0,colspan:S(e)||"alerts"===e?2:1})},_sortData:function(){var e=this.curSortField,r=t.sortBy(this.sumData,function(t){return this._getSortValue(t,e)}.bind(this));return"desc"===this.curSortType?r.reverse():r},_getSortValue:function(e,t){var r=t in e?e[t]:"";switch(t){case"extId":case"alarms":case"alerts":case"total":r=Number(r);break;default:r=r.toLowerCase()}return r},_renderControls:function(){var e=this.model.getTexts();return f({sortFields:this.sortFields,curSortField:this.curSortField,curSortType:this.curSortType,i18n:e})},_initControls:function(){var e=this,t=this.content.find("select[name=sort]"),r=this.content.find("select[name=sortType]");t.on("change",function(){e.curSortField=t.val(),e._rerender()}),r.on("change",function(){e.curSortType=r.val(),e._rerender()})},_rerender:function(){this.$sumTbody.html(this._renderSummaryRows()),this._createHeaderClones()}});return T}),define("_common/reports/alertssummary/AlertssummaryReport",["underscore","_common/reports/Report","_common/reports/alertssummary/views/AlertssummaryReportView"],function(e,t){var r=t.extend({url:App.getBaseUrl()+"reports/ALERTSUM/",constructor:function(){t.apply(this,arguments)},initialize:function(r){t.prototype.initialize.call(this,r);var n=this;this.get("module").getAlertsGroups().done(function(t){n.set("alertGroupId",e.pluck(t,"id"))}),this.setUserData("showDetails",this.get("showDetails")?1:0),this.setUserData("reportSubtype",this.get("reportSubtype"))},getPostParams:function(){var e=t.prototype.getPostParams.call(this);return this.get("showDetails")||(e.hideDetails=1),e.reportSubtype=this.get("reportSubtype"),e}});return r}),define("stat/reports/alertssummary/views/AlertssummaryReportView",["_common/reports/alertssummary/views/AlertssummaryReportView"],function(e){var t=e.extend({constructor:function(){e.apply(this,arguments)},initialize:function(){e.prototype.initialize.apply(this,arguments)}});return t}),define("stat/reports/alertssummary/AlertssummaryReport",["underscore","_common/reports/alertssummary/AlertssummaryReport","./views/AlertssummaryReportView"],function(e,t,r){var n=t.extend({constructor:function(){t.apply(this,arguments)},initialize:function(){t.prototype.initialize.call(this,r)}});return n}),define("_common/reports/nls/reports",{root:{reportsSettings:"Report options",reportPeriod:"Report period",geofenceViolations:"Speeding in geofences",clearReportsList:"Clear the list",reportsCountText:"#n# generated",speedLimitsSettings:"Speeding detection",speedLimit:"Threshold",speedLimitThreshold:"Threshold for speeding detection",speedLimitExt:"Speed limit",exceedStart:"Start of the speeding",exceedValue:"Speeding magnitude",exceedValueInUnits:"Speeding magnitude in #units#",reportsObjectsSort:"Sorting objects in reports",showingOfTracksSegments:"Showing segments of tracks",showAllSelectedSegments:"Show all selected",showLastSelectedSegment:"Show last selected only",byName:"By object name",byId:"By object ID",dayAndObject:"Day/Object",exportToExcel:"Export to Excel",exportToPdf:"Export to pdf",aggressiveDrivingDetection:"Detection of aggressive driving style",accIntensityMoreThan:"Acceleration amount more than",brakingIntensityMoreThan:"Rate of braking more than",detailReport:"Report details",showSharpAcceleration:"Show hard acceleration",showSharpBraking:"Show hardbraking",showSharpCornering:"Show fast cornering",showTimeAndPlaceOfViolation:"Show time and location of every violation",reportsList:"Report list",createScheduleTask:"Add new report",showRunDistanceOnEveryDay:"Show millage for each day",showAllMoves:"Show circulation areas",showAllParks:"Show parkings",showAddress:"Show address/coordinates",moveStart:"Start of driving",moveEnd:"End of driving",moveTime:"Driving time",moveStartEndTime:"Start time and end time of driving",moveStartTime:"Start time of driving",moveEndTime:"End time of driving",moveStartEndPlace:"Start location and end location of driving",moveStartPlace:"Start location of driving",moveEndPlace:"End location of driving",parkTime:"Parking time",avgSpeed:"Average speed",calcConsumBy100kmNorm:"Consumption by standards for 100 km",calcConsumBy1hNorm:"Consumption by standards for 1 h",sumConsumBy100kmNorm:"Summary fuel consumption by standard for 100 km",sumConsumBy1hNorm:"Summary fuel consumption by standard for 1 h",runExtraParamsWarning:"Detection of start and end driving points will significantly delay report creation.",action:"Action",movement:"driving",movementParameters:"Driving parameters",park:"parking",actionStart:"Start",actionEnd:"End",actionTime:"Duration",parkAddress:"Parking location",totalTime:"Total time",totalParkTime:"Total parking time",totalMoveTime:"Total driving time",wayTime:"Driving time",totalDistance:"Total mileage",maxSpeed:"Max speed",placeOfMax:"Speeding location",loadingAddress:"Address loading...",loadAddress:"Load address",showFullTrack:"Show full track",removeReport:"Remove report",notAvailable:"unavailable",dateAndTime:"Date and time",duration:"Duration",totalDuration:"Total duration",avgValue:"Average value",below:"Below",above:"Above",lessThan:"Less than",moreThan:"More than",belowAllowedLevel:"Below allowed level",aboveAllowedLevel:"Above allowed level",minimum:"Min",maximum:"Max",distanceWhile:"Mileage with #t#",vehicleNumber:"Vehicle number",name:"Name",rev:"Device version",glonassLosesCount:"Number of GLONASS losses",glonassLostPoint:"GLONASS loss time",glonassRestorePoint:"GLOMNASS restore time",losesLesser10min:"Losses less than 10 min",losesLonger10min:"Losses longer than 10 min",losesLonger30min:"Losses longer than 30 min",onlineTime:"Online time",offlineTime:"Offline time",minExceedTime:"Minimum speeding time",noSpeedExceeds:"No speeding",totalSpeedLimitExceeds:"Total speedings",totalSpeedingsOfTheThreshold:"Total number of the threshold speedings",totalB1Exceeds:"Total number of the first threshold speedings",totalB2Exceeds:"Total number of the second threshold speedings",actionType:"Event type",placeOfAction:"Event location",acceleration:"Acceleration",deceleration:"Braking",objectReport:{connection:"Connection",connectionTime:"Connection time",coordinates:"Coordinates",coordinatesTime:"Fixture time",power:"Power supply",ignition:"Ignition",set:"Set",notSet:"Not set",missing:"Missing",detected:"Detected",coordsNotDetected:"Not defined",no:"None",turnedOn:"Turned on",turnedOff:"Turned off"},accesscardReport:{date:"Date",idCard:"ID-card",address:"Address / Coordinates",noData:"no data"},normalValue:"Standard",summary:"Summary",summaryData:"Summary",summaryByObject:"Summary by the object",summaryByDay:"Summary by the day",minTimeOfState:"Minimum operate time",minTimeOfStateHelp:"Minimum time required for sensor readings correction",onlySimultaneousTriggering:"Simultaneous actuating only",dataSource:"Data source",dataSourceCan:"Vehicle onboard computer",dataSourceFlowSensor:"Flow-through fuel consumption sensor",dataSourceCisternsFlowSensor:"Flow-through sensor for refuellers",useFlowCalculatedValues:"When connection to the vehicle onboard computer or fuel consumption sensors is not available use expected values based on the real mileage and fuel consumption rate in l/100km",analogSensorForReport:"Analog input for fuel calculation",removePointsOnParks:"Remove points at parkings",removePointsWithNoIgnition:"Remove points with ingnition off",colorChartDependingOnDiscret1:"Color the chart based on the state of the discrete input 1",deviceReport:{date:"Date",time:"Time",event:"Event",eventDuration:"Event duration",run:"Mileage",noData:"No data",deviceStatus:"State of sensors",beforePeriod:"at the beginning of the period",atthePeriod:"within the period",endPeriod:"at the end of the period",sensor:"Sensor",switchedon:"On",switchedoff:"Off",allSensors:"All sensors",allSwitchedOn:"All turned on",allSwitchedOff:"Partly turned on",runswitchedon:"Mileage turned on",runswitchedoff:"Mileage turned off",inclusions:"Number of starts",shutdowns:"Number of deactivations",emergencyPower:"Standby power supply",mainPower:"Main power supply",minDelay:"Selected minimum operate time"},externalSensorTemperature:"External sensor temperature",deviceTemperature:"Device temperature",coolerTemperature:"Cooling liquid temperature",allowedThresholds:"Valid operating range",allowedTemperature:"Valid temperature",minTemperature:"Minimum temperature",maxTemperature:"Maximum temperature",normTemperature:"Standard",violationCount:"Number of violations",factsWhenCount:"Number of segments with #cond#",violationDuration:"Duration of violations",outOfRangeDuration:"Duration out of #range#",violationDistance:"Mileage with violations",outOfRangeDistance:"Mileage out of #range#",minViolationTime:"Minimum time of violation",minOutOfRangeTime:"Out of valid range minimum time",summaryOutRangeWork:"Summary on operation out of valid range",showViolations:"Show violations",noViolations:"No violations",noFacts:"None",toggleDiagram:"#t# chart",toggleViolationChart:"#t# violation chart",toggleTemperatureTimeChart:"#t# temperature chart",vehicleVoltage:"Vehicle voltage",deviceVoltage:"Device battery voltage",allowedVoltageThresholds:"Valid voltage range",allowedVoltage:"Valid voltage",minVoltage:"Minimum voltage",maxVoltage:"Maximum voltage",toggleVoltageTimeChart:"#t# voltage time chart",engineOffState:"Engine off",engineIdleState:"Idle run",engineIdleStateShort:"Idle run",engineIdleStateUpto:"Idle upto",engineLoadState:"On-load operation",engineLoadStateShort:"On-load",engineCriticalRpm:"Extreme rates",engineCriticalRpmAbove:"Extreme rates above",engineCriticalRpmShort:"Extreme",noFactsOfCriticalRpm:"No extreme rates",toggleRpmTimeChart:"#t# chart of vehicle rates",violationOfCriticalRpm:"Extreme rates",splitData:"Split data",splitDataNone:"Do not split",splitDataDays:"By days",splitDataHours:"By houres",zoneReport:{numberZoneVisit:"Geofence visit #",numberCurrentObjVisit:"Object visit #",enterTime:"Time of entrance",exitTime:"Time of exit",timeInZone:"Time inside the geofence",timeOutZone:"Time outside the geofence",runBetweenZoneEnters:"Mileage between visits",visitsCount:"Number of visits",runInZone:"Mileage inside the geofence",runOutZone:"Mileage outside the geofence",firstEnter:"First entrance",lastExit:"Last exit"},geozonesVisitedOfTotal:"From #total# visited",dateTimeOfStart:"Starting date and time",dateTimeOfEnd:"End date and time",fuelsAndDischarges:"Refuelings and discharges",noFuelsOrDischarges:"No refuelings and discharges",beforeValue:"Was",afterValue:"Now",fuelVolumeInTank:"Fuel volume in the tank",startVolume:"Start volume",endVolume:"Final volume",minVolume:"Minimum volume",maxVolume:"Maximum volume",fillingsNumber:"Total refuelings",dayFillingsNumber:"Total refuelings during the day",fillingsVolume:"Refueling volume",dischargesNumber:"Total discharges",dayDischargesNumber:"Total discharges during the day",dischargesVolume:"Volume of discharges",totalFuelConsumption:"Total fuel consumption",fuelConsumption:"Fuel consumption",fuelConsumptionWhileMoving:"Fuel consumption while driving",avgConsumption:"Average consumption",totalRealConsumption:"Total consumption without discharges",consumption100km:"Total consumption",consumption1hIgn:"Total consumption per 1 operating hour",avgConsumption1hIgn:"Average consumption per 1 operating hour",consumWhileMoving:"Fuel consumption while driving",consumWhileMovingShort:"Consumption while driving",consumWhileMoving100km:"Consumption while driving for 100 km",consumption1h:"Consumption per 1 driving hour",engineParameters:"Engine operation parameters",engineWorkTime:"Engine operation time",engineWorkTimeWhileMoving:"Engine operation time while driving",engineWorkTimeOnParks:"Engine operating time on parkings",ignOnTime:"Total time of parkings with ignition on",ignOnParkTime:"Parkings with ignition on",ignOffParkTime:"Parkings with ignition off",ignOnMoveTime:"Driving with ignition on",firstIgnTime:"Engine operation starting time",lastIgnTime:"Engine operation end time",fuelTimeChartTitle:"Fuel versus time based on #source# data",fuelDistanceChartTitle:"Fuel versus mileage based on #source# data",fuelFlowChartTitle:"Fuel consumption in time",byNorm:"by standard",analogueSensor1:"sensor",analogueSensors1:"sensors",parksIgnOn:"Parkings with ignition on",averageCorner:"Medium cornering",agressiveCorner:"Hard cornering",timesAgressiveAcceleration:"Total number of the hard accelerations",timesAgressiveInhibition:"Total number of the hard brakings",timesAgressiveCorners:"Total number of the hard corners",timesAverageCorners:"Total number of the medium corners",scheduleTaskdeleteConfirmMsg:"Unable to restore the job",newReport:"New report",tasksCreationIsImpossible:"Creating of reports is not possible.",tasksEditIsImpossible:"Performing and editing of report is not possible.",propertiesReport:"Report properties",title:"name",reportObjType:"Object type",typeOfReport:"Report type",recipientEmails:"Recipient addresses",objectsWhichReport:"Objects for report creation",previousDay:"Previous day",previousWeek:"Previous week",previousMonth:"Previous month",currentMonth:"Current month",timezoneGenerateReport:"Time zone for report creation",scheduleReportGeneration:"Report creation schedule",startTime:"Start time",daily:"daily",selectedDaysOfWeek:"On selected week days",selectedDaysOfMonth:"On selected month days",reportParameters:"Report options",copyReportParameters:"The report parameter copying",noTasksToCopyReportParameters:"Reports not found for copying",copyReportParametersError:"Failed to copy the report parameters",runImmediately:"Start now",noInfo:"No additional options",allDone:"All right",taskRun:"Job Started",taskSaved:"Job saved",taskDeleted:"Job deleted",objectInZoneTrue:"The object inside the geofence",objectInZoneFalse:"The object outside the geofence",objectInZoneUndefined:"The object inside or outside the geofence",objectFault:"Object fault",noGsmSignalTime:"Offline more than",noGpsSignalTime:"No coordinates more than",timeOfLastAlert:"Last event time",noAlerts:"No events",noAlertsLastTime:"No events more than",noObjectsWithFaultsForReport:"No faulty objects to show in the report",sumOfObjectsWork:"Object operation summary",sumOfObjectsMovesParks:"Mileage and parking summary",showReportDataOnEveryDay:"Show data for each day",selectedAlertGroup:"Selected event group",selectedAlertGroups:"Selected event groups",noSelectedAlertGroups:"No event group selected",totalAlertsAndAlarms:"Total events and alarms",errCanNotBuildReport:"Failed to generate the report due to the server error. Please try again later.",errMaxObjectsForExport:"Maximum number of objects to export this report - #max# (#t# selected).",errSingleObjectOnly:"This report can be created only by one object.",errLongReportPeriod:function(e){var t=["day","days"];return this.whichLabels(e),"Building this report for a period exceeding "+e+"&nbsp;"+t[this.whichLabels(e)]+" is not possible."},errEnterReportName:"Enter report name",errReportNamePattern:'The name cannot contain the <span class="nobr">\\/?%*:|".<></span>characters',errEnterTaskEmails:"Enter at least one email",errEnterTaskEmailsPattern:"Invalid emails:",errEnterCorrectStartTime:"Select valid start time",errslectDaysOfWeek:"Select at least one day of week",errslectDaysOfMonth:"Select at least one day of month",errLimitRequired:"Enter threshold value",errEnterLimitNotLessThan:'Value of the "#name#" field cannot be less than #min#',errMintimeRequired:"Enter time value",errSelectAtLeastOneSensor:"Select at least one sensor.",errSelectAtLeastOneParameter:"Select at least one parameter.",volume:"volume",filling:"refueling",fillings:"refuellings",discharge:"discharge",discharges:"discharges",discretes:{metrics:"Output in a report",historyHeader:"Options status change history",countSwitch:"Number of switchings",countSwitchShort:"# of switchings",dataOn:"Data for on state",distanceOn:"Mileage with on state",distanceOnShort:"Mileage with On",dataOff:"Data for off state",distanceOff:"Mileage with off state",distanceOffShort:"Mileage with Off",periodOn:"Duration at on state",periodOnShort:"Duration at On",periodOff:"Duration at off state",periodOffShort:"Duration at Off"},errPointCoordsNotSpecified:"Points coordinates are not specified.",distanceReport:{timeRangeLabel:"Time range",selectedTimeLabel:"As at",noDataHeader:"There are no data on location of existing objects"},guardsCompleteCallsLabels:["finished visit","finished visits"],guardsComplteteCallsCountShort:"Number of finished visits",guardsNbComplteteCallsOnNbObjects:"Total #calls# to #objects#",drivesafety:{driveStyle:"Driving style",styleParameters:"Driving style indicators",acceleration:"Acceleration",braking:"Braking",speedKeeping:"Speed limits compliance",accelerationParameters:"Acceleration indicators",speedParameters:"Speed limits compliance indicators",accLimit:"Acceleration limit",brakingLimit:"Braking limit",accNumber:"Number of accelerations",brakingNumber:"Number of braking",weight:"Weight",value:"Value",penaltyPoint:"Penalty point",penaltyPoints:"Penalty points",mintime:"Minimum exceed time",mintimeSpeed:"Min speeding time",mintimeAcceleration:"Min acceleration/braking time",mileageWithExcess:"Mileage with speeding",numberOfSpeeding:"Number of speeding",useMileage:"Use the mileage with speeding",useQuantity:"Use the number of speeding",grade:"Grade",overallGrade:"Overall grade",drivingStyleGrade:"Driving style grade",speedingGrade:"Speed limits compliance grade",gradeExcellentDescription:"excellent",gradeGood:"Good",gradeGoodParamLabel:"Good, grade range, up to",gradeGoodLegend:"Good - up to",gradeGoodDescription:"acceptable",gradeMiddle:"Normal",gradeMiddleParamLabel:"Normal, grade range, up to",gradeMiddleLegend:"Normal - up to",gradeMiddleDescription:"requires corrections",gradeBad:"Bad",gradeBadLegend:"Bad - more than",gradeBadDescription:"dangerous",gradeUglyDescription:"inadmissible",objectStatistics:"Object statistics",objectsStatistics:"Objects statistics",showStatistics:"Show the Object statistics",showCalculation:"Counting scores tables",speedCalculation:"Speed limits compliance score counting",styleCalculation:"Driving style score counting",thresholdsSet:"Grades thresholds",speedings:"Speedings of",exceedingMoreThan:"Speeding more than",accelerations:"Accelerations more than",brakings:"Brakes more than",indicator:"Indicator",totalQuantity:"Total number",quantity100km:"Quantity per 100&nbsp;km",value100km:"Value per 100&nbsp;km",indicatorWeight:"Indicator weight",gradeByIndicator:"Score by indicator",penaltyPointsByIndicator:"Penalty points by indicator",summaryScore:"Final score",showSummary:"Summary chart",showTop:"Objects with the worst score",showList:"List of objects",withViolations:"with number of violations",withTotalScore:"with the final score",withViolationsAndTotalScore:"with number of violations and the final score",gradeByGroup:"Average score for the group",gradeDistributionbyObjects:"Distribution of objects' grades",objectsWithWorstScore:"Objects with the worst score",objectsList:"List of objects",objectsListWithTotalScore:"List of objects with a final score",objectsListWithViolationsNumber:"List of objects with the number of violations",speedScore:"Speed limits compliance score",accScore:"Driving style score"},drivesafety2020:{objectsWithWorstScore:"Objects with the worst score",gradeByGroup:"Average score for the group",speedCalculation:"Speed limits compliance penalty points and score counting",styleCalculation:"Driving style penalty points and score counting"},passQuantity:"Number of passengers",passQuantityExt:"Number of incomers and outcomers",sumPassQuantity:"Total number of passengers",sumPassQuantityExt:"Total number of incomers and outcomers",pass:{door:"Door",enteredShort:"Boarded",exitedShort:"Alighted",enteredTotalShort:"Entered. Overall",exitedTotalShort:"Alighted. Overall"},totalAlertsAndLogEntries:"Total records in the journal",totalActionsAndComments:"Actions and users' comments",totalUsers:"Total users",objservice:{serviceStatuses:"Maintenance",roundinglabel:'Need to rounded up to a full day while in the "Maintenance" status, if the object was in that status any time during the day'},engine:"Engine",driveline:"Driveline",drivelineFull:"Driveline",accelerometer:"Accelerometer",discreteInput:"Discrete input",discreteInputs:"Discrete inputs",timeseries:{geolocation:"Geolocation",satellites:"Satelittes",altitude:"Altitude",beingInGeozone:"Being in the geofence",crossingTheGeozone:"Crossing the geofence",navMileage:"Navigation mileage",carBody:"Body",carDoorFrontLeft:"Front left door",carDoorFrontRight:"Front right door",carDoorRearRight:"Rear right door",carDoorRearLeft:"Rear left door",carHood:"Hood",carCompartment:"Luggage compartment",carSecuritySystemIsOn:"Security system of the vehicle activated",carSecuritySystem:"Standard security system",carCentralLock:"Central lock",electricEquipment:"Electric equipment",carExternalVoltage:"External voltage",deviceInternalVoltage:"Internal voltage",carIgnitionKey:"Key in the ignition lock",carAccessories:"Accessories",carParkingLights:"Parking lights",carDippedBeam:"Dipped beam",carHighBeam:"High beam",carSafetyBelt:"Safety belt",carWiperFront:"Front windshield wiper",carDirIndicatorLeft:"Left direction indicator",carDirIndicatorRight:"Right direction indicator",drivelineInD:"Automatic gearbox in D, motion",drivelineInR:"Automatic gearbox in R, back run",drivelineInN:"Automatic gearbox in N, neutral",drivelineInP:"Automatic gearbox in P, parking",breakPedal:"Brake pedal",parkingBreak:"Parking brake",operationalMode:"Operational mode",machineHoursDevice:"Machine hours (device)",coolingFluidTemperature:"Cooling fluid",engineSpeed:"Engine speed",instantaneousFlowRate:"Instantaneous flow rate",machineHours:"Machine hours",totalMileage:"Total mileage",totalMileageToMaintenance:"Total mileage to maintenance",ignition:"Ignition",engineStarted:"Engine started",inclination:"Inclination",impact:"Impact",accident:"Accident",carTip:"Tip",carRollOver:"Roll over",carTest:"Test",lowInternalBattery:"Low internal battery",configurationCable:"Configuration cable",remoteSoftware:"Remote software",tamper:"Tamper",fix3d:"3D fixation",callEvent:"Call",externalBattery:"External battery",externalSupply:"External supply",chargeEvent:"Charge",reloadEvent:"Reload",navigation:"Navigation",communication:"Communication",makeAndBreakGerkon:"Make-and-break Gerkon",externalFieldGerkon:"External field Gerkon",externalGerkon:"External Gerkon",accessDenied:"Access denied",newWirelessNetworkEvent:"New wireless network",connectionRetention:"Connection retention",trackingEvent:"Tracking",readerEvent:"Reader",discreteInputDin:"Discrete input DIN",controlOut:"OUT",debugging:"Debugging",cpuTemperarure:"Temperature CPU",wire1Temperarure:"Temperature 1-Wire",temperatureInRefSection:"Refrigerator temperature in section",temperatureSpecifiedN:"Set temperature",ambientTemperature:"Ambient temperature",coolantTemperature:"Coolant temperature",temperatureAnalogueSensor:"Temperature of Analog Sensor",iqfreezeRpm:"Engine RPM",iqfreezeConf:"Compressor configuration",iqfreezeConf2:"2nd section compressor configuration",iqfreezeConf3:"3rd section compressor configuration",iqfreezeState:"State",iqfreezeState2:"2nd section state",iqfreezeState3:"3rd section state",iqfreezeBatv:"Battery voltage",iqfreezeBata:"Battery amperage",iqfreezeHm:"Engine hours",iqfreezeHme:"Line voltage operating hours",iqfreezeHmt:"General hours",iqfreezeAlcount:"Error count",iqfreezeAl1:"The most important error code",iqfreezeAl2:"Code of the 2nd most important error",iqfreezeAl3:"Code of the 2rd most important error",iqfreezeAl4:"Code of the 4th most important error",iqfreezeAl5:"Code of the 5th most important error",iqfreezeAl6:"Code of the 6th most important error",iqfreezeAdcErrN:"An error on the sensor #n#",iqfreezeRefType:"Type of refrigerator",iqfreezeDr:"Door status",iqfreezeDr2:"2nd section's door status",iqfreezeDr3:"3rd section's door status",iqfreezeNoConnect:"Lack of communication with the refrigerator",iqfreezeInN:"Discrete input #n#. Digital input iQfreeze",iqfreezeLic:"iQFreeze license type",iqfreezeDevType:"iQFreeze type",fuelSensorHzShort:"Hz",fuelSensorAdcShort:"ADC",accelerationXAxis:"X-axis acceleration (ACC_X)",accelerationYAxis:"X-axis acceleration (ACC_X)",accelerationZAxis:"Z-axis acceleration (ACC_Z)",tangage:"Tangage",vehicleRoll:"Roll",gsmSignalLevel:"GSM signal level",wifiSignalLevel:"WiFi signal level",lbsCell:"Cell",lbsZone:"Zone",lbsLevel:"Level",gsmSuppression:"GSM suppression",fmsParameters:"FMS-parameters",fmsParameterKey:function(e){return"Parameter "+e+" Key (CAN)"},fmsParameterValue:function(e){return"Parameter "+e+" Value (CAN)"},carAxisNumber:"Axis number",carAxelLoad:"Axle Load"}},"ru-ru":!0,"it-it":!0}),define("_common/reports/nls/ru-ru/reports",{reportsSettings:" ",reportPeriod:" ",geofenceViolations:"  ",clearReportsList:" ",reportsCountText:" #n#",speedLimitsSettings:"  ",speedLimit:"",speedLimitThreshold:"  ",speedLimitExt:" ",exceedStart:" ",exceedValue:" ",exceedValueInUnits:"   #units#",reportsObjectsSort:"   ",showingOfTracksSegments:"  ",showAllSelectedSegments:"  ",showLastSelectedSegment:"   ",byName:"  ",byId:" ID ",dayAndObject:"/",exportToExcel:"  Excel",exportToPdf:"  Pdf",aggressiveDrivingDetection:"   ",accIntensityMoreThan:"  ",brakingIntensityMoreThan:"  ",detailReport:" ",showSharpAcceleration:"  ",showSharpBraking:"  ",showSharpCornering:"   ",showTimeAndPlaceOfViolation:"     ",reportsList:" ",createScheduleTask:"  ",showRunDistanceOnEveryDay:"    ",showAllMoves:"  ",showAllParks:" ",showAddress:" /",moveStart:" ",moveEnd:" ",moveTime:" ",moveStartEndTime:"    ",moveStartTime:"  ",moveEndTime:"  ",moveStartEndPlace:"    ",moveStartPlace:"  ",moveEndPlace:"  ",parkTime:" ",avgSpeed:" ",calcConsumBy100kmNorm:"    100 ",calcConsumBy1hNorm:"    1 ",sumConsumBy100kmNorm:"     100 ",sumConsumBy1hNorm:"     1 ",runExtraParamsWarning:"         .",action:"",movement:"",movementParameters:" ",park:"",actionStart:"",actionEnd:"",actionTime:"",parkAddress:" ",totalTime:" ",totalParkTime:"   ",totalMoveTime:"   ",wayTime:"  ",totalDistance:" ",maxSpeed:". ",placeOfMax:" ",loadingAddress:" ...",loadAddress:" ",showFullTrack:"  ",removeReport:" ",notAvailable:" ",dateAndTime:"  ",duration:"",totalDuration:" ",avgValue:" ",below:"",above:"",lessThan:"",moreThan:"",belowAllowedLevel:"  ",aboveAllowedLevel:"  ",minimum:"",maximum:"",distanceWhile:"  #t#",vehicleNumber:" ",name:"",rev:" ",glonassLosesCount:"-  ",glonassLostPoint:"  ",glonassRestorePoint:"  ",losesLesser10min:",  10 .",losesLonger10min:",  10 .",losesLonger30min:",  30 .",onlineTime:" on-line",offlineTime:" off-line",minExceedTime:"  ",noSpeedExceeds:"  ",totalSpeedLimitExceeds:" ",totalSpeedingsOfTheThreshold:"  ",totalB1Exceeds:"   ",totalB2Exceeds:"   ",actionType:" ",placeOfAction:" ",acceleration:"",deceleration:"",objectReport:{connection:"",connectionTime:" ",coordinates:"",coordinatesTime:"  ",power:"",ignition:"",set:"",notSet:"",missing:"",detected:"",coordsNotDetected:" ",no:"",turnedOn:"",turnedOff:""},accesscardReport:{date:"",idCard:"ID-",address:" / ",noData:" "},normalValue:"",summary:"",summaryData:" ",summaryByObject:"  ",summaryByDay:"  ",minTimeOfState:"  ",minTimeOfStateHelp:" ,      ",onlySimultaneousTriggering:"  ",dataSource:" ",dataSourceCan:"  ",dataSourceFlowSensor:"   ",dataSourceCisternsFlowSensor:"   ",useFlowCalculatedValues:"                       /100",analogSensorForReport:"    ",removePointsOnParks:"   ",removePointsWithNoIgnition:"    ",colorChartDependingOnDiscret1:"        1",deviceReport:{date:"",time:"",event:"",eventDuration:" ",run:"",noData:" ",deviceStatus:" ",beforePeriod:"  ",atthePeriod:"  ",endPeriod:"  ",sensor:"",switchedon:".",switchedoff:".",allSensors:" ",allSwitchedOn:" ",allSwitchedOff:" ",runswitchedon:" .",runswitchedoff:" .",inclusions:"- ",shutdowns:"- ",emergencyPower:" ",mainPower:" ",minDelay:"   :"},externalSensorTemperature:"  ",deviceTemperature:" ",coolerTemperature:"  ",allowedThresholds:"  ",allowedTemperature:" ",minTemperature:" ",maxTemperature:" ",normTemperature:"",violationCount:" ",factsWhenCount:"   #cond#",violationDuration:" ",outOfRangeDuration:"  #range#",violationDistance:"  ",outOfRangeDistance:"  #range#",minViolationTime:"  ",minOutOfRangeTime:"     ",summaryOutRangeWork:"      ",showViolations:"  ",noViolations:" ",noFacts:" ",toggleDiagram:"#t# ",toggleViolationChart:"#t#  ",toggleTemperatureTimeChart:"#t#  ",vehicleVoltage:"  ",deviceVoltage:"  ",allowedVoltageThresholds:"  ",allowedVoltage:" ",minVoltage:" ",maxVoltage:" ",toggleVoltageTimeChart:"#t#  ",engineOffState:"",engineIdleState:" ",engineIdleStateShort:" ",engineIdleStateUpto:"  ",engineLoadState:"  ",engineLoadStateShort:" ",engineCriticalRpm:" ",engineCriticalRpmAbove:"  ",engineCriticalRpmShort:"",noFactsOfCriticalRpm:"   ",toggleRpmTimeChart:"#t#   ",violationOfCriticalRpm:"  ",splitData:" ",splitDataNone:" ",splitDataDays:" ",splitDataHours:" ",zoneReport:{numberZoneVisit:"  ",numberCurrentObjVisit:"  ",enterTime:" ",exitTime:" ",timeInZone:"  ",timeOutZone:"  ",runBetweenZoneEnters:"  ",visitsCount:" ",runInZone:"  ",runOutZone:"  ",firstEnter:" ",lastExit:" "},geozonesVisitedOfTotal:" #total# ",dateTimeOfStart:"   ",dateTimeOfEnd:"   ",fuelsAndDischarges:"  ",noFuelsOrDischarges:"    ",beforeValue:"",afterValue:"",fuelVolumeInTank:"   ",startVolume:" ",endVolume:" ",minVolume:" ",maxVolume:" ",fillingsNumber:" ",dayFillingsNumber:"    ",fillingsVolume:" ",dischargesNumber:" ",dayDischargesNumber:"    ",dischargesVolume:" ",totalFuelConsumption:"  ",fuelConsumption:" ",fuelConsumptionWhileMoving:"   ",avgConsumption:" ",totalRealConsumption:"    ",consumption100km:" ",consumption1hIgn:"   1  ",avgConsumption1hIgn:"   1  ",consumWhileMoving:"   ",consumWhileMovingShort:"  ",consumWhileMoving100km:"    100  ",consumption1h:"  1  ",engineParameters:"  ",engineWorkTime:"  ",engineWorkTimeWhileMoving:"    ",engineWorkTimeOnParks:"    ",ignOnTime:"    ",ignOnParkTime:"   ",ignOffParkTime:"   ",ignOnMoveTime:"   ",firstIgnTime:"   ",lastIgnTime:"   ",fuelTimeChartTitle:"     #source#",fuelDistanceChartTitle:"     #source#",fuelFlowChartTitle:"   ",byNorm:" ",analogueSensor1:"",analogueSensors1:"",parksIgnOn:"   ",averageCorner:" ",agressiveCorner:" ",timesAgressiveAcceleration:"   ",timesAgressiveInhibition:"   ",timesAgressiveCorners:"  ",timesAverageCorners:"  ",scheduleTaskdeleteConfirmMsg:"    ",newReport:" ",tasksCreationIsImpossible:"  .",tasksEditIsImpossible:"    .",propertiesReport:" ",title:"",reportObjType:" ",typeOfReport:" ",recipientEmails:" ",objectsWhichReport:",    ",previousDay:" ",previousWeek:" ",previousMonth:" ",currentMonth:" ",timezoneGenerateReport:"    ",scheduleReportGeneration:"  ",startTime:" ",daily:"",selectedDaysOfWeek:"   ",selectedDaysOfMonth:"   ",reportParameters:" ",copyReportParameters:"  ",noTasksToCopyReportParameters:"    ",copyReportParametersError:"    ",runImmediately:" ",noInfo:"  ",allDone:"  ",taskRun:" ",taskSaved:" ",taskDeleted:" ",objectInZoneTrue:"   ",objectInZoneFalse:"   ",objectInZoneUndefined:"     ",objectFault:" ",noGsmSignalTime:"   ",noGpsSignalTime:"  ",timeOfLastAlert:"  ",noAlerts:" ",noAlertsLastTime:"  ",noObjectsWithFaultsForReport:"      ",sumOfObjectsWork:"   ",sumOfObjectsMovesParks:"    ",showReportDataOnEveryDay:"    ",selectedAlertGroup:"  ",selectedAlertGroups:"  ",noSelectedAlertGroups:"     ",totalAlertsAndAlarms:"   ",errCanNotBuildReport:"        .   .",errMaxObjectsForExport:"       - #max# ( #t#).",errSingleObjectOnly:"        .",errLongReportPeriod:function(e){var t=["","",""];
return this.whichLabels(e),"     ,  "+e+" "+t[this.whichLabels(e)]+" "},errEnterReportName:"  ",errReportNamePattern:'     <span class="nobr">\\/?%*:|".<></span>',errEnterTaskEmails:"    e-mail ",errEnterTaskEmailsPattern:"   E-Mail:",errEnterCorrectStartTime:"   ",errslectDaysOfWeek:"     ",errslectDaysOfMonth:"     ",errLimitRequired:"  ",errEnterLimitNotLessThan:'  "#name#"     #min#',errMintimeRequired:"  ",errSelectAtLeastOneSensor:"    .",errSelectAtLeastOneParameter:"    .",volume:"",filling:"",fillings:"",discharge:"",discharges:"",discretes:{metrics:"  ",historyHeader:"   ",countSwitch:" ",countSwitchShort:"- ",dataOn:"   ",distanceOn:"   ",distanceOnShort:'  ""',dataOff:"   ",distanceOff:"   ",distanceOffShort:'  ""',periodOn:"   ",periodOnShort:'  ""',periodOff:"   ",periodOffShort:'  ""'},errPointCoordsNotSpecified:"   .",distanceReport:{timeRangeLabel:" ",selectedTimeLabel:"  ",noDataHeader:"     "},guardsCompleteCallsLabels:[" "," "," "],guardsComplteteCallsCountShort:"-  ",guardsNbComplteteCallsOnNbObjects:" #calls#  #objects#",drivesafety:{driveStyle:" ",styleParameters:"  ",acceleration:"",braking:"",speedKeeping:" ",accelerationParameters:" ",speedParameters:"  ",accLimit:" ",brakingLimit:" ",accNumber:" ",brakingNumber:" ",weight:"",value:"",penaltyPoint:" ",penaltyPoints:" ",mintime:" ",mintimeSpeed:"   ",mintimeAcceleration:"    /",mileageWithExcess:"  ",numberOfSpeeding:" ",useMileage:"   ",useQuantity:"  ",grade:"",overallGrade:" ",drivingStyleGrade:"  ",speedingGrade:"  ",gradeExcellentDescription:"",gradeGood:"",gradeGoodParamLabel:",   , ",gradeGoodLegend:" - ",gradeGoodDescription:"",gradeMiddle:"",gradeMiddleParamLabel:",   , ",gradeMiddleLegend:" - ",gradeMiddleDescription:" ",gradeBad:"",gradeBadLegend:" - ",gradeBadDescription:"",gradeUglyDescription:"",objectStatistics:"  ",objectsStatistics:"  ",showCalculation:"  ",speedCalculation:"   ",styleCalculation:"   ",thresholdsSet:" ",speedings:"",exceedingMoreThan:" ",accelerations:" &gt;",brakings:" &gt;",indicator:"",totalQuantity:" -",quantity100km:"-  100&nbsp;",value100km:"  100&nbsp;",indicatorWeight:" ",gradeByIndicator:"  ",penaltyPointsByIndicator:"   ",summaryScore:" ",showSummary:" ",showTop:"   ",showList:" ",withViolations:"  ",withTotalScore:"  ",withViolationsAndTotalScore:"     ",gradeByGroup:"   ",gradeDistributionbyObjects:"   ",objectsWithWorstScore:"   ",objectsList:" ",objectsListWithTotalScore:"    ",speedScore:"  ",accScore:"  "},drivesafety2020:{objectsWithWorstScore:"   ",gradeByGroup:"  ",speedCalculation:"      ",styleCalculation:"      "},passQuantity:" ",passQuantityExt:"-   ",sumPassQuantity:" - ",sumPassQuantityExt:" -   ",pass:{door:"",enteredShort:"",exitedShort:"",enteredTotalShort:" ",exitedTotalShort:" "},totalAlertsAndLogEntries:"   ",totalActionsAndComments:"   ",totalUsers:" ",objservice:{serviceStatuses:" ",roundinglabel:'        "",           '},engine:"",driveline:"",drivelineFull:" ",accelerometer:"",discreteInput:" ",discreteInputs:" ",timeseries:{geolocation:"",satellites:" ",altitude:"   ",beingInGeozone:"  ",crossingTheGeozone:"    ",navMileage:" ",carBody:"",carDoorFrontLeft:"  ",carDoorFrontRight:"  ",carDoorRearRight:"  ",carDoorRearLeft:"  ",carHood:"",carCompartment:"",carSecuritySystemIsOn:"  ",carSecuritySystem:"  ",carCentralLock:" ",electricEquipment:"",carExternalVoltage:" ",deviceInternalVoltage:"  ",carIgnitionKey:"   ",carAccessories:"",carParkingLights:" ",carDippedBeam:" ",carHighBeam:" ",carSafetyBelt:" ",carWiperFront:" ",carDirIndicatorLeft:"  ",carDirIndicatorRight:"  ",drivelineInD:"  D, ",drivelineInR:"  R,  ",drivelineInN:"  N, ",drivelineInP:"  P, ",breakPedal:" ",parkingBreak:" ",operationalMode:" ",machineHoursDevice:" ()",coolingFluidTemperature:"  ",engineSpeed:" ",instantaneousFlowRate:" ",machineHours:"",totalMileage:" ",totalMileageToMaintenance:"  ",ignition:"",engineStarted:" ",inclination:"",impact:"",accident:"",carTip:"",carRollOver:"",carTest:"",lowInternalBattery:"  ",configurationCable:" ",remoteSoftware:" ",tamper:"",fix3d:" 3D",callEvent:"",externalBattery:" ",externalSupply:" ",chargeEvent:"",reloadEvent:"",navigation:"",communication:"",makeAndBreakGerkon:"  ",externalFieldGerkon:" . ",externalGerkon:" ",accessDenied:" ",newWirelessNetworkEvent:" ",connectionRetention:" ",trackingEvent:"",readerEvent:"",discreteInputDin:"  ",controlOut:" ",debugging:"",cpuTemperarure:" CPU",wire1Temperarure:" 1-Wire",temperatureInRefSection:"   ",temperatureSpecifiedN:" ",ambientTemperature:"  ",coolantTemperature:"  ",temperatureAnalogueSensor:"  ",iqfreezeRpm:" ",iqfreezeConf:" ",iqfreezeConf2:"    2",iqfreezeConf3:"    3",iqfreezeState:" ",iqfreezeState2:"    2",iqfreezeState3:"    3",iqfreezeBatv:" ",iqfreezeBata:"  ",iqfreezeHm:"   ",iqfreezeHme:"   ",iqfreezeHmt:" ",iqfreezeAlcount:" ",iqfreezeAl1:"   ",iqfreezeAl2:" 2   ",iqfreezeAl3:" 3   ",iqfreezeAl4:" 4   ",iqfreezeAl5:" 5   ",iqfreezeAl6:" 6   ",iqfreezeAdcErrN:"    #n#",iqfreezeRefType:" ",iqfreezeDr:" ",iqfreezeDr2:"    2",iqfreezeDr3:"    3",iqfreezeNoConnect:"   ",iqfreezeInN:"  #n#.   iQfreeze",iqfreezeLic:"  iQFreeze",iqfreezeDevType:"  iQFreeze",fuelSensorHzShort:" ",fuelSensorAdcShort:" ",accelerationXAxis:" X",accelerationYAxis:" X",accelerationZAxis:" Z",tangage:"",vehicleRoll:"",gsmSignalLevel:" GSM",wifiSignalLevel:" WiFi",lbsCell:"",lbsZone:"",lbsLevel:"",gsmSuppression:" GSM",fmsParameters:"FMS-",fmsParameterKey:function(e){return"  "+e+" (CAN)"},fmsParameterValue:function(e){return"  "+e+" (CAN)"},carAxisNumber:" ",carAxelLoad:"  "}}),define("_common/reports/alerts/AlertsReport",["underscore","_common/reports/Report","i18n!_common/reports/nls/reports"],function(e,t){var r=t.extend({url:App.getBaseUrl()+"reports/ALERTS/",constructor:function(){t.apply(this,arguments)},initialize:function(r){var n=this.get("alertGroupId");n?e.isNumber(n)&&(n=[n]):n=[],this.set("alertGroupId",n),this.setUserData("alertGroupId",n),t.prototype.initialize.call(this,r)},getPostParams:function(){var e=t.prototype.getPostParams.call(this);return e.alertGroupId=this.get("alertGroupId"),e},readyForExport:function(){return!1}});return r.reportName=App.getTexts().reportsNames.alerts,r}),define("text!_common/reports/alerts/tmpl/thead.html",[],function(){return'<tr data-head="<%= headPosition %>">\n    <th data-key="alertTs"><%= i18n.timeOfCreation %></th>\n    <th data-key="receivedAt"><%= i18n.timeOfReceive %></th>\n    <th data-key="code"><%= i18n.alertCode %></th>\n    <th data-key="message"><%= i18n.alert.ucFirst() %></th>\n    <th data-key="group"><%= i18n.alertsGroup %></th>\n    <th data-key="areaZone"><%= i18n.objZoneKey %></th>\n    <th data-key="areaZoneName"><%= i18n.objZoneKeyName %></th>\n    <th data-key="area"><%= i18n.objArea %></th>\n    <th data-key="areaName"><%= i18n.objAreaName %></th>\n    <th data-key="channelName"><%= i18n.inputStream %></th>\n</tr>'}),define("text!_common/reports/alerts/tmpl/row.html",[],function(){return'<tr<% if(isLast) {%> data-row="last"<% } %>>\n    <td data-key="alertTs" data-value="<%= alertTs %>"><%= alertTsS %></td>\n    <td data-key="receivedAt" data-value="<%= receivedAt %>"><%= receivedAtS %></td>\n    <td data-key="code"><%= code %></td>\n    <td data-key="message" class="text-left"><%- message %></td>\n    <td data-key="group"><%= \'undefined\' != typeof group && group ? group : \'-\' %></td>\n    <td data-key="areaZone"><%= \'undefined\' != typeof areaZone ? areaZone : \'-\' %></td>\n    <td data-key="areaZoneName"><%= \'undefined\' != typeof areaZoneName && areaZoneName ? areaZoneName : \'-\' %></td>\n    <td data-key="area"><%= \'undefined\' != typeof area ? area : \'-\' %></td>\n    <td data-key="areaName"><%= \'undefined\' != typeof areaName && areaName ? areaName : \'-\' %></td>\n    <td data-key="channelName"><%= \'undefined\' != typeof channelName && channelName ? channelName : \'-\' %></td>\n</tr>'}),define("text!_common/reports/alerts/tmpl/rowObject.html",[],function(){return"<tr class=\"obj\">\n    <td colspan=\"<%= colspan %>\" class=\"summary\">\n        <div class=\"sum-content\">\n            <% if(groups.length) {%>\n                <%= i18n['selectedAlertGroup' + ( groups.length == 1 ? '' : 's' )] %>:\n                <strong><%= groups.join(', ').toLowerCase().ucFirst() %></strong>\n\n                <br /><%= i18n[alarms ? ( alerts ? 'totalAlertsAndAlarms' : 'totalAlarms' ) : 'totalAlerts'] %>:\n                <strong><%= total %></strong>\n            <% } else { %>\n                <%= i18n.noSelectedAlertGroups %>\n            <% } %>\n        </div>\n    </td>\n</tr>"}),define("text!_common/reports/tmpl/noDataRow.html",[],function(){return'<tr<% if (\'undefined\' != typeof rowPosition){ %> data-row="<%= rowPosition %>"\n<% } else if(\'undefined\' != typeof isLast && isLast) {%> data-row="last"<% } %>>\n    <td class="text-left no-data"<%if(!_.isUndefined(colspan)) {%> colspan="<%= colspan %>"<% } %>><%- text %></td>\n</tr>'}),define("_common/reports/alerts/views/AlertsReportView",["jquery","underscore","../../views/ReportView","text!../../tmpl/reportTable.html","text!../tmpl/thead.html","text!../../tmpl/day.html","text!../tmpl/row.html","text!../tmpl/rowObject.html","text!../../tmpl/noDataRow.html"],function(e,t,r,n,i,a,o,s,l){n=t.template(n),i=t.template(i),a=t.template(a),o=t.template(o),s=t.template(s),l=t.template(l);var d=1,c=r.extend({FIX_HEADER:1,render:function(){var t=new e.Deferred;r.prototype.render.apply(this,arguments),this.$el.addClass("alerts-report"),this.buildMetaInfo(),this.content.append(n({key:this.model.get("key"),theadHtml:'<colgroup><col style="width:9%"><col style="width:9%"><col style="width:8%"><col style="width:22%"><col style="width:9%"><col style="width:7%"><col style="width:9%"><col style="width:8%"><col style="width:10%"><col style="width:9%"></colgroup>'}));var i=this.content.find("tbody");return i.append(this._buildRows()),t.resolve(),t},_buildRows:function(){for(var e,r,n=this,c=this.model.getTexts(),m="",u=this.model.get("body"),p=this.model.get("footer"),h=this.model.get("header"),f=h.keyOrder,g=this.model.get("alertGroupId"),v=g.length?t.pluck(h.groups,"name"):[],b=-1!=t.indexOf(g,d),y=[],S=0,T="",x=0,w={},k=0,_=[],D=0,A=null,C=10,j=0,O=f.length;O>j;++j)if(e=f[j],r=u[e],A=p[e],m+=s({i18n:c,colspan:C,groups:v,alarms:b,alerts:b&&v.length>1||!b&&v.length,total:A.alerts+A.alarms}),v.length){m+=i({i18n:c,headPosition:++k}),y=t.filter(t.keys(r),function(e){return!t.isNaN(Number(e))});for(var R=y.length;R--;)if(T=y[R],x=Number(T),m+=a({rowPosition:0==S++?"first":"",colspan:C,dateStr:n.formatDate(x)+" ("+n.getDayOfWeek(x)+")",isWeekend:n.isWeekend(x)}),T in r&&"alerts"in r[T]&&r[T].alerts.length){_=r[T].alerts,D=_.length;for(var P=0;D>P;++P)w=_[P],w.alertTsS=n.formatTime(w.alertTs),w.receivedAtS=n.formatTime(w.receivedAt),w.isLast=y.length==S&&P==D-1,m+=o(w)}else m+=l({rowPosition:y.length-1==S?"last":0,text:c.noDataForDay,colspan:C})}return m}});return c}),define("stat/reports/alerts/views/AlertsReportView",["_common/reports/alerts/views/AlertsReportView"],function(e){var t=e.extend({constructor:function(){e.apply(this,arguments)},initialize:function(){e.prototype.initialize.apply(this,arguments)}});return t}),define("stat/reports/alerts/AlertsReport",["underscore","_common/reports/alerts/AlertsReport","stat/reports/alerts/views/AlertsReportView"],function(e,t,r){var n=t.extend({constructor:function(){t.apply(this,arguments)},initialize:function(){t.prototype.initialize.call(this,r)}});return n});