define(["underscore","_common/reports/Report","./views/DiscretesReportView","_common/tracks/TracksModule"],function(t,e,s,r){var i=e.extend({url:App.getBaseUrl()+"reports/DISCRETEPARAMETERS/",constructor:function(){this.addressesLoaded=!1,e.apply(this,arguments)},defaults:t.extend({},e.prototype.defaults,{properties:["extId","name"],parameterNums:[],metrics:["switch"],dur:5,showHistory:!1}),initialize:function(){var a=null;this.has("source")&&(a=this.get("module").items.get(this.get("source"))),a?a instanceof i?this.set(a.pick("dur","parameterNums","metrics","properties")):a.registerChild(this):this.set("dur",Math.max(this.get("dur"),1));var o=this.get("parameterNums"),h=this.get("metrics");1===this.get("objectId").length?t.indexOf(h,"history")>-1&&(this.set("showHistory",!0),this.addressesLoaded=!1):"history"===h&&(h=["switch","history"],this.set("metrics",h)),Array.isArray(o)||(o=[o]),this.set("parameterNums",o.map(function(t){return String(t)})),"string"==typeof h&&this.set("metrics",[h]),this.makeTracksModule(r),e.prototype.initialize.call(this,s),this._prepareDeviceProperties(),this.setUserData("dur",this.get("dur")),this.setUserData("parameterNums",this.get("parameterNums")),this.setUserData("metrics",this.get("metrics"))},getPostParams:function(){var t=e.prototype.getPostParams.call(this);return t.properties=this.get("properties"),t.parameterNums=this.get("parameterNums"),t.metrics=this.get("metrics"),t.dur=this.get("dur"),t},getMetricsDataFields:function(){var e=t.indexBy(this.get("metrics")),s=[];return"switch"in e&&s.push("countSwitch"),"on"in e&&(s.push("distanceOn"),s.push("periodOn")),"off"in e&&(s.push("distanceOff"),s.push("periodOff")),s}});return i});