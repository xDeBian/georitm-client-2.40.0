define(["jquery","underscore","../../views/ReportView","text!../tmpl/progress.html","text!../tmpl/success.html"],function(e,r,t,s,n){s=r.template(s),n=r.template(n);var o=t.extend({constructor:function(){this.$results=null,t.apply(this,arguments)},render:function(){var r=new e.Deferred,s=this.model;return t.prototype.render.apply(this,arguments),this.$el.addClass("report-no-footer alertjournal-report"),this.buildMetaInfo(),this.$results=e('<div class="rep-results" />').appendTo(this.content),this._renderProgress(),this.listenTo(s,"change:percent",this._updateProgress).listenTo(s,"change:error",this._renderError),r.resolve(),r},onAfterRender:function(){},_renderProgress:function(){var e=this.model;this.$results.html(s({i18n:e.getTexts(),id:e.id,percent:Math.round(e.get("percent"))})),this.$results.find(".btn-cancel").on("click",function(){e.remove()})},_updateProgress:function(e,r){return r>=100?this._renderSuccess():(this._renderProgress(),void 0)},_renderSuccess:function(){var e=this.model;this.$results.html(n({i18n:e.getTexts()}))},_renderError:function(e,r){r&&this.$results.html('<p class="error">'+r+"</p>")}});return o});