define(["jquery","underscore","_common/reports/views/ReportView","text!_common/reports/tmpl/reportTable.html"],function(e,t,n,s){var o=n.extend({constructor:function(){this._headIndex=0,n.apply(this,arguments)},_tmplHead:null,_tmplRow:null,render:function(){var o=this.model,r=new e.Deferred,l=o.getTexts(),a=o.get("nbObjects"),i=o.get("footer").total||0;n.prototype.render.apply(this,arguments),this.$el.addClass("guardscallcount-report"),this.buildMetaInfo(),this.content.append(t.template(s,{key:o.get("key")}));var d=i+"&nbsp;"+l.guardsCompleteCallsLabels[l.whichLabels(i)],p=a+"&nbsp;"+l.objectsLabels[l.whichLabels(a)],c=this._tmplHead({i18n:l,showTable:i>0,summaryText:l.guardsNbComplteteCallsOnNbObjects.replace("#calls#",d).replace("#objects#",p)});return i>0&&(c+=this._buildRows()),this.content.find("tbody").append(c),this.content.on("click",".history-link",function(){App.trigger("needdevicehistory",{id:e(this).data("id"),objType:"stat"==o.get("objType")?App.TYPE_STAT:App.TYPE_MOBILE})}),r.resolve(),r},_buildRows:function(){for(var e,t=this.model.get("body").callCounts,n=this._tmplRow,s="",o=this.model.getTexts(),r=0,l=t.length;l>r;++r)e=t[r],s+=n({index:r+1,isLast:r==l-1,id:e.id,extId:e.extId,name:e.name,address:e.addr||o.notEntered,count:e.count});return s}});return o});