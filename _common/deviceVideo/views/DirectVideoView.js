define(["jquery","underscore","jqueryui","jface","_libs/hls/hls.light","abstracts/View","text!../tmpl/direct.html","css!../css/camera.css"],function(t,e,i,n,s,l,o){o=e.template(o);var r=l.extend({constructor:function(){this.controller=null,this.hls=null,this.video=null,l.apply(this,arguments)},initialize:function(t){this.controller=t.controller,this.render(),"port"in t&&null!==t.port&&this.loadStream(t.port),h.bindEvents.call(this)},render:function(){this.video=this.$el.find("video")[0]},loadStream:function(t){if(s.isSupported()){this.stop();var e=this.video,i=this.controller.getStreamUrl(t),n=this._hls=new s({debug:!0,enableWorker:!0});n.loadSource(i),n.attachMedia(e),n.on(s.Events.MANIFEST_PARSED,function(){e.play()})}else alert("Hls video is not supported")},fitSize:function(){console.log("fitSize called")},fitSizeInPopup:function(){console.log("fitSizeInPopup called")},stop:function(){this._hls&&(this._hls.destroy(),this._hls.bufferTimer&&(clearInterval(this._hls.bufferTimer),this._hls.bufferTimer=null),this._hls=null)},remove:function(){this.stopListening(),this.stop(),this.$el.remove()}}),h={bindEvents:function(){var t=this.controller;t.get("modeMulti")||this.listenTo(t,"change:port",function(t,e){null!==e?this.loadStream(e):this.stop()})},bindUIEvents:function(){}};return r});